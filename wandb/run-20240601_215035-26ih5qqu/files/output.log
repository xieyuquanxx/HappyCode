
  0%|▎                                                                        | 4/930 [00:02<09:39,  1.60it/s]
{'loss': 3.8582, 'grad_norm': 4.331585884094238, 'learning_rate': 3.225806451612903e-06, 'epoch': 0.03}

  1%|▋                                                                        | 8/930 [00:04<07:07,  2.16it/s]

  1%|▉                                                                       | 12/930 [00:06<07:52,  1.94it/s]

  2%|█▏                                                                      | 16/930 [00:08<07:58,  1.91it/s]
{'loss': 3.8075, 'grad_norm': 3.9914844036102295, 'learning_rate': 1.6129032258064517e-05, 'epoch': 0.16}

  2%|█▋                                                                      | 21/930 [00:10<06:32,  2.32it/s]

  3%|█▉                                                                      | 25/930 [00:12<06:47,  2.22it/s]
{'loss': 3.7237, 'grad_norm': 4.423668384552002, 'learning_rate': 2.5806451612903226e-05, 'epoch': 0.26}

  3%|██▎                                                                     | 30/930 [00:14<06:26,  2.33it/s]
{'loss': 3.5506, 'grad_norm': 4.0517706871032715, 'learning_rate': 3.2258064516129034e-05, 'epoch': 0.32}

  4%|██▋                                                                     | 35/930 [00:16<06:17,  2.37it/s]

  4%|███                                                                     | 40/930 [00:19<06:19,  2.35it/s]
{'loss': 3.444, 'grad_norm': 4.024303436279297, 'learning_rate': 4.1935483870967746e-05, 'epoch': 0.42}

  5%|███▍                                                                    | 44/930 [00:20<06:16,  2.35it/s]

  5%|███▊                                                                    | 49/930 [00:22<06:10,  2.38it/s]
{'loss': 3.2585, 'grad_norm': 4.126452445983887, 'learning_rate': 5.161290322580645e-05, 'epoch': 0.52}

  6%|████▏                                                                   | 54/930 [00:24<06:06,  2.39it/s]

  6%|████▍                                                                   | 57/930 [00:26<07:50,  1.85it/s]
{'loss': 3.0663, 'grad_norm': 3.8407514095306396, 'learning_rate': 6.129032258064517e-05, 'epoch': 0.61}

  7%|████▋                                                                   | 61/930 [00:28<07:31,  1.93it/s]

  7%|█████                                                                   | 66/930 [00:31<06:31,  2.21it/s]
{'loss': 2.6663, 'grad_norm': 4.309483528137207, 'learning_rate': 7.096774193548388e-05, 'epoch': 0.71}

  8%|█████▍                                                                  | 71/930 [00:33<06:08,  2.33it/s]

  8%|█████▊                                                                  | 75/930 [00:34<06:06,  2.33it/s]
{'loss': 2.4447, 'grad_norm': 3.9873719215393066, 'learning_rate': 8.064516129032258e-05, 'epoch': 0.81}

  9%|██████▏                                                                 | 80/930 [00:36<05:59,  2.37it/s]

  9%|██████▌                                                                 | 85/930 [00:39<06:22,  2.21it/s]
{'loss': 1.9927, 'grad_norm': 3.7258405685424805, 'learning_rate': 9.032258064516129e-05, 'epoch': 0.9}

 10%|██████▉                                                                 | 89/930 [00:40<05:59,  2.34it/s]
{'loss': 1.8393, 'grad_norm': 3.2908976078033447, 'learning_rate': 9.677419354838711e-05, 'epoch': 0.97}
 10%|███████▏                                                                | 93/930 [00:42<05:07,  2.72it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32

 62%|█████████████████████████████████████████████▋                           | 15/24 [00:02<00:01,  5.30it/s]
Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-93/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-93/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-93/preprocessor_config.json
{'loss': 1.4856, 'grad_norm': 3.1712048053741455, 'learning_rate': 9.99968302372402e-05, 'epoch': 1.03}
 11%|███████▌                                                                | 98/930 [00:49<09:57,  1.39it/s]

 11%|███████▊                                                               | 103/930 [00:51<06:23,  2.15it/s]
{'loss': 1.3404, 'grad_norm': 2.8132882118225098, 'learning_rate': 9.99714745464859e-05, 'epoch': 1.1}

 12%|████████▏                                                              | 108/930 [00:53<05:31,  2.48it/s]
{'loss': 1.1135, 'grad_norm': 2.625623941421509, 'learning_rate': 9.992077602401357e-05, 'epoch': 1.16}

 12%|████████▋                                                              | 113/930 [00:55<05:33,  2.45it/s]

 13%|█████████                                                              | 118/930 [00:56<05:12,  2.60it/s]
{'loss': 0.9082, 'grad_norm': 1.9374492168426514, 'learning_rate': 9.979727018613607e-05, 'epoch': 1.26}

 13%|█████████▍                                                             | 123/930 [00:58<05:18,  2.54it/s]
{'loss': 0.7661, 'grad_norm': 2.0157082080841064, 'learning_rate': 9.968335515358916e-05, 'epoch': 1.32}

 14%|█████████▊                                                             | 128/930 [01:01<05:25,  2.47it/s]

 14%|██████████▏                                                            | 133/930 [01:03<05:06,  2.60it/s]
{'loss': 0.7401, 'grad_norm': 2.2992920875549316, 'learning_rate': 9.94652603162896e-05, 'epoch': 1.42}

 15%|██████████▍                                                            | 137/930 [01:04<06:10,  2.14it/s]

 15%|██████████▊                                                            | 142/930 [01:07<06:20,  2.07it/s]
{'loss': 0.5135, 'grad_norm': 1.7936034202575684, 'learning_rate': 9.919072471964145e-05, 'epoch': 1.52}

 16%|███████████                                                            | 145/930 [01:08<06:18,  2.07it/s]

 16%|███████████▍                                                           | 149/930 [01:10<06:41,  1.94it/s]

 17%|███████████▊                                                           | 154/930 [01:13<05:51,  2.21it/s]
{'loss': 0.5199, 'grad_norm': 1.5274126529693604, 'learning_rate': 9.873743117270691e-05, 'epoch': 1.65}

 17%|████████████                                                           | 158/930 [01:14<05:25,  2.38it/s]

 18%|████████████▍                                                          | 163/930 [01:17<05:54,  2.16it/s]
{'loss': 0.3621, 'grad_norm': 1.2464356422424316, 'learning_rate': 9.833252929587232e-05, 'epoch': 1.74}

 18%|████████████▋                                                          | 167/930 [01:19<06:00,  2.12it/s]

 18%|█████████████▏                                                         | 172/930 [01:21<05:20,  2.36it/s]
{'loss': 0.3323, 'grad_norm': 1.4174407720565796, 'learning_rate': 9.787247912633179e-05, 'epoch': 1.84}

 19%|█████████████▌                                                         | 177/930 [01:23<05:06,  2.46it/s]
{'loss': 0.36, 'grad_norm': 1.2454578876495361, 'learning_rate': 9.753539772350792e-05, 'epoch': 1.9}

 20%|█████████████▉                                                         | 182/930 [01:25<04:54,  2.54it/s]
{'loss': 0.4145, 'grad_norm': 1.4131609201431274, 'learning_rate': 9.717420893549902e-05, 'epoch': 1.97}
 20%|██████████████▏                                                        | 186/930 [01:26<04:26,  2.79it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32


Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-186/config.json
{'eval_loss': 0.3230985105037689, 'eval_accuracy': 0.9215155615696887, 'eval_runtime': 5.0213, 'eval_samples_per_second': 147.172, 'eval_steps_per_second': 4.78, 'epoch': 2.0}
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-186/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-186/preprocessor_config.json
 20%|██████████████▍                                                        | 189/930 [01:33<13:29,  1.09s/it]

 21%|██████████████▊                                                        | 194/930 [01:35<06:31,  1.88it/s]
{'loss': 0.2972, 'grad_norm': 1.141478419303894, 'learning_rate': 9.658762842283343e-05, 'epoch': 2.06}

 21%|███████████████▏                                                       | 199/930 [01:37<05:03,  2.41it/s]
{'loss': 0.2447, 'grad_norm': 1.2499547004699707, 'learning_rate': 9.616699907856368e-05, 'epoch': 2.13}

 22%|███████████████▌                                                       | 204/930 [01:39<05:08,  2.36it/s]

 22%|███████████████▉                                                       | 209/930 [01:41<04:45,  2.53it/s]
{'loss': 0.2694, 'grad_norm': 1.0981312990188599, 'learning_rate': 9.549222483594153e-05, 'epoch': 2.23}

 23%|████████████████▎                                                      | 214/930 [01:43<04:46,  2.50it/s]
{'loss': 0.2321, 'grad_norm': 1.1720012426376343, 'learning_rate': 9.501348789257373e-05, 'epoch': 2.29}

 24%|████████████████▋                                                      | 219/930 [01:45<04:44,  2.50it/s]

 24%|█████████████████                                                      | 224/930 [01:47<04:44,  2.48it/s]
{'loss': 0.2249, 'grad_norm': 0.9257315993309021, 'learning_rate': 9.425265825193076e-05, 'epoch': 2.39}

 25%|█████████████████▍                                                     | 229/930 [01:49<04:49,  2.42it/s]
{'loss': 0.2052, 'grad_norm': 0.9153513312339783, 'learning_rate': 9.371733080722911e-05, 'epoch': 2.45}

 25%|█████████████████▊                                                     | 234/930 [01:51<04:31,  2.56it/s]

 26%|██████████████████▏                                                    | 239/930 [01:53<04:37,  2.49it/s]
{'loss': 0.2058, 'grad_norm': 0.9505445957183838, 'learning_rate': 9.287285680653254e-05, 'epoch': 2.55}

 26%|██████████████████▌                                                    | 243/930 [01:55<05:43,  2.00it/s]

 27%|██████████████████▊                                                    | 247/930 [01:57<05:27,  2.08it/s]
{'loss': 0.2634, 'grad_norm': 1.0472021102905273, 'learning_rate': 9.197946409848194e-05, 'epoch': 2.65}

 27%|███████████████████▏                                                   | 252/930 [01:59<04:48,  2.35it/s]

 28%|███████████████████▌                                                   | 257/930 [02:01<04:32,  2.47it/s]
{'loss': 0.2026, 'grad_norm': 0.8300455808639526, 'learning_rate': 9.103817206036382e-05, 'epoch': 2.74}

 28%|████████████████████                                                   | 262/930 [02:03<04:20,  2.56it/s]
{'loss': 0.2156, 'grad_norm': 1.2079710960388184, 'learning_rate': 9.038456146928325e-05, 'epoch': 2.81}

 29%|████████████████████▍                                                  | 267/930 [02:05<04:15,  2.59it/s]

 29%|████████████████████▋                                                  | 271/930 [02:07<05:03,  2.17it/s]
{'loss': 0.1564, 'grad_norm': 0.837329089641571, 'learning_rate': 8.936585038732141e-05, 'epoch': 2.9}

 30%|█████████████████████▏                                                 | 277/930 [02:09<04:21,  2.50it/s]
{'loss': 0.1792, 'grad_norm': 1.2070980072021484, 'learning_rate': 8.866168181896198e-05, 'epoch': 2.97}
 30%|█████████████████████▎                                                 | 279/930 [02:10<03:48,  2.85it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32

 75%|██████████████████████████████████████████████████████▊                  | 18/24 [00:03<00:01,  5.56it/s]
Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-279/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-279/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-279/preprocessor_config.json
Deleting older checkpoint [checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-93] due to args.save_total_limit
 30%|█████████████████████▍                                                 | 280/930 [02:15<15:55,  1.47s/it]

 31%|█████████████████████▊                                                 | 285/930 [02:17<06:38,  1.62it/s]

 31%|██████████████████████▏                                                | 290/930 [02:19<04:48,  2.22it/s]
{'loss': 0.1565, 'grad_norm': 0.8790881037712097, 'learning_rate': 8.719489039427256e-05, 'epoch': 3.1}

 32%|██████████████████████▌                                                | 295/930 [02:21<04:19,  2.44it/s]
{'loss': 0.1582, 'grad_norm': 0.8292447924613953, 'learning_rate': 8.643301141529619e-05, 'epoch': 3.16}

 32%|██████████████████████▉                                                | 300/930 [02:23<04:21,  2.41it/s]

 33%|███████████████████████▎                                               | 305/930 [02:25<04:04,  2.56it/s]
{'loss': 0.1011, 'grad_norm': 0.389802485704422, 'learning_rate': 8.525567215680398e-05, 'epoch': 3.26}

 33%|███████████████████████▋                                               | 310/930 [02:27<04:04,  2.53it/s]
{'loss': 0.1654, 'grad_norm': 0.8255307674407959, 'learning_rate': 8.444834595378434e-05, 'epoch': 3.32}

 34%|████████████████████████                                               | 315/930 [02:29<04:00,  2.55it/s]

 34%|████████████████████████▍                                              | 320/930 [02:31<04:12,  2.41it/s]
{'loss': 0.1466, 'grad_norm': 0.918765127658844, 'learning_rate': 8.320473013836196e-05, 'epoch': 3.42}

 35%|████████████████████████▋                                              | 324/930 [02:33<04:58,  2.03it/s]

 35%|█████████████████████████                                              | 328/930 [02:35<05:10,  1.94it/s]
{'loss': 0.167, 'grad_norm': 0.7938557863235474, 'learning_rate': 8.192322712349917e-05, 'epoch': 3.52}

 36%|█████████████████████████▎                                             | 332/930 [02:37<04:10,  2.39it/s]

 36%|█████████████████████████▋                                             | 337/930 [02:39<03:59,  2.48it/s]
{'loss': 0.1639, 'grad_norm': 1.0500552654266357, 'learning_rate': 8.060529912738315e-05, 'epoch': 3.61}

 37%|██████████████████████████                                             | 342/930 [02:41<03:54,  2.50it/s]
{'loss': 0.1103, 'grad_norm': 0.5810715556144714, 'learning_rate': 7.970718531101365e-05, 'epoch': 3.68}

 37%|██████████████████████████▍                                            | 347/930 [02:43<03:51,  2.52it/s]

 38%|██████████████████████████▊                                            | 351/930 [02:44<04:01,  2.40it/s]

 38%|██████████████████████████▊                                            | 352/930 [02:47<09:28,  1.02it/s]

 38%|███████████████████████████▏                                           | 356/930 [02:48<05:07,  1.86it/s]

 39%|███████████████████████████▍                                           | 360/930 [02:51<04:54,  1.94it/s]
{'loss': 0.1615, 'grad_norm': 0.8259062170982361, 'learning_rate': 7.692430845412945e-05, 'epoch': 3.87}

 39%|███████████████████████████▊                                           | 365/930 [02:53<04:08,  2.27it/s]

 40%|████████████████████████████▏                                          | 370/930 [02:55<03:53,  2.40it/s]
{'loss': 0.1349, 'grad_norm': 0.5543167591094971, 'learning_rate': 7.548598528940353e-05, 'epoch': 3.97}
 40%|████████████████████████████▍                                          | 372/930 [02:55<03:23,  2.75it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32

 83%|████████████████████████████████████████████████████████████▊            | 20/24 [00:03<00:00,  5.52it/s]
Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-372/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-372/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-372/preprocessor_config.json
Deleting older checkpoint [checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-186] due to args.save_total_limit
 40%|████████████████████████████▌                                          | 374/930 [03:01<10:57,  1.18s/it]

 41%|████████████████████████████▉                                          | 379/930 [03:03<05:05,  1.80it/s]
{'loss': 0.1104, 'grad_norm': 0.6503041982650757, 'learning_rate': 7.401858215313228e-05, 'epoch': 4.06}

 41%|█████████████████████████████▎                                         | 384/930 [03:05<03:48,  2.39it/s]
{'loss': 0.1698, 'grad_norm': 1.1416596174240112, 'learning_rate': 7.302498337922293e-05, 'epoch': 4.13}

 42%|█████████████████████████████▋                                         | 389/930 [03:07<03:31,  2.56it/s]

 42%|██████████████████████████████                                         | 394/930 [03:09<03:38,  2.46it/s]
{'loss': 0.1026, 'grad_norm': 1.015479564666748, 'learning_rate': 7.15128498868873e-05, 'epoch': 4.23}

 43%|██████████████████████████████▍                                        | 399/930 [03:11<03:42,  2.39it/s]
{'loss': 0.0882, 'grad_norm': 0.7107292413711548, 'learning_rate': 7.049101623982937e-05, 'epoch': 4.29}

 43%|██████████████████████████████▊                                        | 404/930 [03:13<03:25,  2.56it/s]

 44%|███████████████████████████████▏                                       | 409/930 [03:15<03:28,  2.50it/s]
{'loss': 0.1024, 'grad_norm': 0.6903170347213745, 'learning_rate': 6.89389442805288e-05, 'epoch': 4.39}

 45%|███████████████████████████████▌                                       | 414/930 [03:17<03:23,  2.54it/s]
{'loss': 0.0932, 'grad_norm': 0.4976060390472412, 'learning_rate': 6.789211390929497e-05, 'epoch': 4.45}

 45%|███████████████████████████████▉                                       | 419/930 [03:19<03:28,  2.46it/s]

 46%|████████████████████████████████▎                                      | 424/930 [03:21<03:35,  2.35it/s]
{'loss': 0.1535, 'grad_norm': 0.8402358889579773, 'learning_rate': 6.630502193549474e-05, 'epoch': 4.55}

 46%|████████████████████████████████▊                                      | 429/930 [03:23<03:16,  2.55it/s]
{'loss': 0.1067, 'grad_norm': 0.6478976607322693, 'learning_rate': 6.523651220265268e-05, 'epoch': 4.61}

 47%|█████████████████████████████████▏                                     | 434/930 [03:25<03:33,  2.32it/s]

 47%|█████████████████████████████████▌                                     | 439/930 [03:27<03:15,  2.52it/s]
{'loss': 0.0945, 'grad_norm': 0.4989892840385437, 'learning_rate': 6.361942964380967e-05, 'epoch': 4.71}

 48%|█████████████████████████████████▉                                     | 444/930 [03:29<03:07,  2.59it/s]

 48%|██████████████████████████████████▏                                    | 448/930 [03:31<03:42,  2.17it/s]
{'loss': 0.1355, 'grad_norm': 0.968318521976471, 'learning_rate': 6.198680706867892e-05, 'epoch': 4.81}

 49%|██████████████████████████████████▌                                    | 452/930 [03:33<04:28,  1.78it/s]

 49%|██████████████████████████████████▉                                    | 457/930 [03:35<03:41,  2.13it/s]
{'loss': 0.1531, 'grad_norm': 0.4585718810558319, 'learning_rate': 6.034050732923537e-05, 'epoch': 4.9}

 50%|███████████████████████████████████▎                                   | 462/930 [03:37<03:17,  2.38it/s]
{'loss': 0.1197, 'grad_norm': 0.802198588848114, 'learning_rate': 5.923630280085948e-05, 'epoch': 4.97}
 50%|███████████████████████████████████▌                                   | 465/930 [03:38<02:51,  2.71it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32

 71%|███████████████████████████████████████████████████▋                     | 17/24 [00:02<00:01,  5.53it/s]
Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-465/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-465/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-465/preprocessor_config.json
Deleting older checkpoint [checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-372] due to args.save_total_limit
 50%|███████████████████████████████████▊                                   | 469/930 [03:45<07:00,  1.10it/s]
{'loss': 0.0856, 'grad_norm': 0.8745437264442444, 'learning_rate': 5.812741411877982e-05, 'epoch': 5.03}

 51%|████████████████████████████████████                                   | 473/930 [03:47<04:27,  1.71it/s]

 51%|████████████████████████████████████▍                                  | 478/930 [03:49<03:12,  2.34it/s]
{'loss': 0.0753, 'grad_norm': 0.4983646273612976, 'learning_rate': 5.645652906778808e-05, 'epoch': 5.13}

 52%|████████████████████████████████████▊                                  | 483/930 [03:51<03:00,  2.47it/s]

 52%|█████████████████████████████████████▎                                 | 488/930 [03:53<02:59,  2.47it/s]
{'loss': 0.1053, 'grad_norm': 0.7495405673980713, 'learning_rate': 5.477827700000492e-05, 'epoch': 5.23}

 53%|█████████████████████████████████████▋                                 | 493/930 [03:55<02:56,  2.47it/s]
{'loss': 0.1053, 'grad_norm': 0.5640295147895813, 'learning_rate': 5.3656294858563803e-05, 'epoch': 5.29}

 54%|██████████████████████████████████████                                 | 498/930 [03:57<02:49,  2.55it/s]

 54%|██████████████████████████████████████▍                                | 503/930 [03:59<02:45,  2.57it/s]
{'loss': 0.099, 'grad_norm': 0.8065477609634399, 'learning_rate': 5.197002296068878e-05, 'epoch': 5.39}

 55%|██████████████████████████████████████▊                                | 508/930 [04:01<02:47,  2.52it/s]
{'loss': 0.1368, 'grad_norm': 1.0028190612792969, 'learning_rate': 5.084447400069655e-05, 'epoch': 5.45}

 55%|███████████████████████████████████████▏                               | 513/930 [04:03<02:43,  2.54it/s]

 56%|███████████████████████████████████████▌                               | 518/930 [04:05<02:46,  2.48it/s]
{'loss': 0.0831, 'grad_norm': 0.7497930526733398, 'learning_rate': 4.915552599930345e-05, 'epoch': 5.55}

 56%|███████████████████████████████████████▉                               | 523/930 [04:07<02:46,  2.45it/s]

 57%|████████████████████████████████████████▎                              | 528/930 [04:09<02:37,  2.55it/s]
{'loss': 0.0834, 'grad_norm': 0.7238893508911133, 'learning_rate': 4.746754155806437e-05, 'epoch': 5.65}

 57%|████████████████████████████████████████▋                              | 533/930 [04:11<02:38,  2.50it/s]
{'loss': 0.075, 'grad_norm': 0.44978123903274536, 'learning_rate': 4.6343705141436195e-05, 'epoch': 5.71}

 58%|█████████████████████████████████████████                              | 538/930 [04:13<02:40,  2.45it/s]

 58%|█████████████████████████████████████████▍                             | 543/930 [04:15<02:32,  2.54it/s]
{'loss': 0.088, 'grad_norm': 0.8162854313850403, 'learning_rate': 4.466160514232206e-05, 'epoch': 5.81}

 59%|█████████████████████████████████████████▊                             | 548/930 [04:17<02:30,  2.54it/s]
{'loss': 0.0896, 'grad_norm': 0.9842413067817688, 'learning_rate': 4.354347093221194e-05, 'epoch': 5.87}

 59%|██████████████████████████████████████████▏                            | 552/930 [04:19<02:47,  2.26it/s]
 60%|██████████████████████████████████████████▌                            | 558/930 [04:21<02:14,  2.77it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32
  8%|██████▏                                                                   | 2/24 [00:00<00:01, 11.19it/s]
{'loss': 0.0992, 'grad_norm': 0.534956693649292, 'learning_rate': 4.187258588122019e-05, 'epoch': 5.97}


Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-558/config.json
{'eval_loss': 0.1871163249015808, 'eval_accuracy': 0.9445196211096076, 'eval_runtime': 4.2494, 'eval_samples_per_second': 173.908, 'eval_steps_per_second': 5.648, 'epoch': 6.0}
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-558/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-558/preprocessor_config.json
Deleting older checkpoint [checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-279] due to args.save_total_limit
 60%|██████████████████████████████████████████▊                            | 561/930 [04:27<06:06,  1.01it/s]

 61%|███████████████████████████████████████████▏                           | 566/930 [04:29<03:02,  1.99it/s]
{'loss': 0.0624, 'grad_norm': 0.5655715465545654, 'learning_rate': 4.021097435717385e-05, 'epoch': 6.06}

 61%|███████████████████████████████████████████▌                           | 571/930 [04:31<02:31,  2.38it/s]

 62%|███████████████████████████████████████████▉                           | 576/930 [04:33<02:19,  2.55it/s]
{'loss': 0.0812, 'grad_norm': 0.7763584852218628, 'learning_rate': 3.856053228896442e-05, 'epoch': 6.16}

 63%|████████████████████████████████████████████▍                          | 582/930 [04:36<02:19,  2.50it/s]
{'loss': 0.1085, 'grad_norm': 0.7416663765907288, 'learning_rate': 3.746737338706397e-05, 'epoch': 6.23}

 63%|████████████████████████████████████████████▊                          | 587/930 [04:37<02:12,  2.59it/s]
{'loss': 0.0786, 'grad_norm': 0.9311794638633728, 'learning_rate': 3.6380570356190344e-05, 'epoch': 6.29}

 64%|█████████████████████████████████████████████▏                         | 592/930 [04:40<02:19,  2.42it/s]

 64%|█████████████████████████████████████████████▌                         | 596/930 [04:41<02:37,  2.12it/s]

 65%|█████████████████████████████████████████████▊                         | 600/930 [04:43<02:44,  2.01it/s]
{'loss': 0.1051, 'grad_norm': 0.791633665561676, 'learning_rate': 3.422823307573722e-05, 'epoch': 6.42}

 65%|██████████████████████████████████████████████                         | 604/930 [04:45<02:25,  2.23it/s]

 65%|██████████████████████████████████████████████▍                        | 608/930 [04:47<02:14,  2.40it/s]

 66%|██████████████████████████████████████████████▌                        | 610/930 [04:50<04:49,  1.11it/s]

 66%|██████████████████████████████████████████████▉                        | 615/930 [04:52<02:31,  2.08it/s]
{'loss': 0.1034, 'grad_norm': 0.7920513153076172, 'learning_rate': 3.158330337390565e-05, 'epoch': 6.58}

 67%|███████████████████████████████████████████████▎                       | 620/930 [04:53<02:04,  2.50it/s]
{'loss': 0.1077, 'grad_norm': 0.6549892425537109, 'learning_rate': 3.0541209343448376e-05, 'epoch': 6.65}

 67%|███████████████████████████████████████████████▋                       | 625/930 [04:56<02:03,  2.47it/s]

 68%|████████████████████████████████████████████████                       | 630/930 [04:58<02:00,  2.48it/s]
{'loss': 0.0553, 'grad_norm': 0.5057859420776367, 'learning_rate': 2.8996735429324255e-05, 'epoch': 6.74}

 68%|████████████████████████████████████████████████▍                      | 634/930 [04:59<02:08,  2.30it/s]

 69%|████████████████████████████████████████████████▋                      | 638/930 [05:01<02:21,  2.06it/s]
{'loss': 0.0614, 'grad_norm': 0.2664738893508911, 'learning_rate': 2.7476226621086354e-05, 'epoch': 6.84}

 69%|█████████████████████████████████████████████████                      | 643/930 [05:04<02:09,  2.22it/s]

 69%|█████████████████████████████████████████████████▎                     | 646/930 [05:05<02:00,  2.36it/s]
{'loss': 0.0948, 'grad_norm': 0.4833539128303528, 'learning_rate': 2.598141784686775e-05, 'epoch': 6.94}
 70%|█████████████████████████████████████████████████▋                     | 651/930 [05:06<01:41,  2.76it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32
 17%|████████████▎                                                             | 4/24 [00:00<00:02,  7.12it/s]


Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-651/config.json
{'eval_loss': 0.18050944805145264, 'eval_accuracy': 0.9485791610284168, 'eval_runtime': 4.4677, 'eval_samples_per_second': 165.411, 'eval_steps_per_second': 5.372, 'epoch': 7.0}
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-651/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-651/preprocessor_config.json
Deleting older checkpoint [checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-465] due to args.save_total_limit
 70%|█████████████████████████████████████████████████▉                     | 654/930 [05:13<04:41,  1.02s/it]

 71%|██████████████████████████████████████████████████▎                    | 659/930 [05:15<02:38,  1.71it/s]
{'loss': 0.0543, 'grad_norm': 0.4917374551296234, 'learning_rate': 2.4031260802275623e-05, 'epoch': 7.06}

 71%|██████████████████████████████████████████████████▌                    | 663/930 [05:17<02:08,  2.08it/s]

 72%|██████████████████████████████████████████████████▉                    | 668/930 [05:19<01:45,  2.48it/s]
{'loss': 0.0633, 'grad_norm': 0.4331863224506378, 'learning_rate': 2.2602997354900075e-05, 'epoch': 7.16}

 72%|███████████████████████████████████████████████████▎                   | 672/930 [05:21<02:14,  1.92it/s]

 73%|███████████████████████████████████████████████████▌                   | 676/930 [05:23<02:11,  1.93it/s]

 73%|███████████████████████████████████████████████████▉                   | 680/930 [05:25<01:49,  2.28it/s]
{'loss': 0.0751, 'grad_norm': 0.3428170084953308, 'learning_rate': 2.074755007023461e-05, 'epoch': 7.29}

 74%|████████████████████████████████████████████████████▎                  | 686/930 [05:27<01:35,  2.56it/s]
{'loss': 0.0622, 'grad_norm': 0.5413922667503357, 'learning_rate': 1.984184589692602e-05, 'epoch': 7.35}

 74%|████████████████████████████████████████████████████▋                  | 690/930 [05:29<01:41,  2.37it/s]

 75%|████████████████████████████████████████████████████▉                  | 694/930 [05:31<01:56,  2.03it/s]
{'loss': 0.102, 'grad_norm': 0.5475680828094482, 'learning_rate': 1.8512108410229878e-05, 'epoch': 7.45}

 75%|█████████████████████████████████████████████████████▎                 | 698/930 [05:33<01:52,  2.07it/s]

 75%|█████████████████████████████████████████████████████▌                 | 702/930 [05:35<01:52,  2.02it/s]

 76%|█████████████████████████████████████████████████████▉                 | 707/930 [05:37<01:40,  2.22it/s]
{'loss': 0.078, 'grad_norm': 0.3474120795726776, 'learning_rate': 1.6795269861638042e-05, 'epoch': 7.58}

 77%|██████████████████████████████████████████████████████▎                | 712/930 [05:39<01:27,  2.50it/s]

 77%|██████████████████████████████████████████████████████▋                | 717/930 [05:41<01:22,  2.59it/s]
{'loss': 0.0716, 'grad_norm': 0.4246102273464203, 'learning_rate': 1.555165404621567e-05, 'epoch': 7.68}

 78%|███████████████████████████████████████████████████████                | 722/930 [05:43<01:21,  2.54it/s]
{'loss': 0.0683, 'grad_norm': 0.6391873359680176, 'learning_rate': 1.4744327843196043e-05, 'epoch': 7.74}

 78%|███████████████████████████████████████████████████████▌               | 727/930 [05:45<01:21,  2.48it/s]
{'loss': 0.0799, 'grad_norm': 0.45697206258773804, 'learning_rate': 1.3954881412079945e-05, 'epoch': 7.81}

 79%|███████████████████████████████████████████████████████▉               | 732/930 [05:47<01:17,  2.57it/s]

 79%|████████████████████████████████████████████████████████▎              | 737/930 [05:49<01:16,  2.51it/s]
{'loss': 0.0651, 'grad_norm': 0.621870219707489, 'learning_rate': 1.280510960572745e-05, 'epoch': 7.9}
 80%|████████████████████████████████████████████████████████▊              | 744/930 [05:51<01:04,  2.90it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32
{'loss': 0.0369, 'grad_norm': 0.23110374808311462, 'learning_rate': 1.2062093865360458e-05, 'epoch': 7.97}
{'loss': 0.0629, 'grad_norm': 0.32969069480895996, 'learning_rate': 1.1697777844051105e-05, 'epoch': 8.0}

 88%|███████████████████████████████████████████████████████████████▉         | 21/24 [00:03<00:00,  5.52it/s]
Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-744/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-744/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-744/preprocessor_config.json
Deleting older checkpoint [checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-558] due to args.save_total_limit
 80%|████████████████████████████████████████████████████████▉              | 746/930 [05:57<03:40,  1.20s/it]

 81%|█████████████████████████████████████████████████████████▎             | 751/930 [05:59<01:45,  1.69it/s]

 81%|█████████████████████████████████████████████████████████▋             | 756/930 [06:01<01:13,  2.38it/s]
{'loss': 0.0436, 'grad_norm': 0.43632277846336365, 'learning_rate': 1.063414961267859e-05, 'epoch': 8.1}

 82%|██████████████████████████████████████████████████████████             | 760/930 [06:03<01:18,  2.18it/s]

 82%|██████████████████████████████████████████████████████████▎            | 764/930 [06:05<01:20,  2.05it/s]
{'loss': 0.0788, 'grad_norm': 0.5715630054473877, 'learning_rate': 9.615438530716753e-06, 'epoch': 8.19}

 83%|██████████████████████████████████████████████████████████▋            | 769/930 [06:07<01:09,  2.31it/s]

 83%|███████████████████████████████████████████████████████████            | 774/930 [06:09<01:04,  2.41it/s]
{'loss': 0.0844, 'grad_norm': 0.4760400652885437, 'learning_rate': 8.64280696599008e-06, 'epoch': 8.29}

 84%|███████████████████████████████████████████████████████████▍           | 779/930 [06:11<00:59,  2.53it/s]
{'loss': 0.0764, 'grad_norm': 0.4727587103843689, 'learning_rate': 8.02053590151805e-06, 'epoch': 8.35}

 84%|███████████████████████████████████████████████████████████▊           | 784/930 [06:14<01:00,  2.42it/s]

 85%|████████████████████████████████████████████████████████████▏          | 789/930 [06:15<00:54,  2.58it/s]
{'loss': 0.0557, 'grad_norm': 0.7380253672599792, 'learning_rate': 7.127143193467445e-06, 'epoch': 8.45}

 85%|████████████████████████████████████████████████████████████▌          | 794/930 [06:17<00:54,  2.51it/s]
{'loss': 0.0556, 'grad_norm': 0.4273008406162262, 'learning_rate': 6.558664474545817e-06, 'epoch': 8.52}

 86%|████████████████████████████████████████████████████████████▉          | 799/930 [06:19<00:51,  2.56it/s]

 86%|█████████████████████████████████████████████████████████████▍         | 804/930 [06:21<00:51,  2.42it/s]
{'loss': 0.0805, 'grad_norm': 0.6975349187850952, 'learning_rate': 5.747341748069229e-06, 'epoch': 8.61}

 87%|█████████████████████████████████████████████████████████████▊         | 809/930 [06:23<00:48,  2.50it/s]
{'loss': 0.0561, 'grad_norm': 0.775609016418457, 'learning_rate': 5.234456860473042e-06, 'epoch': 8.68}

 88%|██████████████████████████████████████████████████████████████▏        | 814/930 [06:25<00:45,  2.57it/s]
{'loss': 0.0548, 'grad_norm': 0.38645973801612854, 'learning_rate': 4.744274637483936e-06, 'epoch': 8.74}

 88%|██████████████████████████████████████████████████████████████▌        | 819/930 [06:27<00:44,  2.51it/s]

 89%|██████████████████████████████████████████████████████████████▉        | 825/930 [06:30<00:40,  2.58it/s]
{'loss': 0.0576, 'grad_norm': 0.6419853568077087, 'learning_rate': 4.05210941898847e-06, 'epoch': 8.84}

 89%|███████████████████████████████████████████████████████████████▎       | 829/930 [06:31<00:38,  2.59it/s]
{'loss': 0.0698, 'grad_norm': 0.6184303760528564, 'learning_rate': 3.619745961260623e-06, 'epoch': 8.9}

 90%|███████████████████████████████████████████████████████████████▋       | 835/930 [06:33<00:36,  2.59it/s]
{'loss': 0.077, 'grad_norm': 0.5997514724731445, 'learning_rate': 3.2109040622582186e-06, 'epoch': 8.97}
 90%|███████████████████████████████████████████████████████████████▉       | 837/930 [06:34<00:31,  2.92it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32

 83%|████████████████████████████████████████████████████████████▊            | 20/24 [00:03<00:00,  5.48it/s]
Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-837/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-837/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-837/preprocessor_config.json
Deleting older checkpoint [checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-651] due to args.save_total_limit
 90%|████████████████████████████████████████████████████████████████       | 839/930 [06:40<01:47,  1.18s/it]

 91%|████████████████████████████████████████████████████████████████▎      | 843/930 [06:41<00:58,  1.49it/s]

 91%|████████████████████████████████████████████████████████████████▋      | 847/930 [06:44<00:46,  1.77it/s]

 92%|████████████████████████████████████████████████████████████████▉      | 851/930 [06:45<00:37,  2.10it/s]
{'loss': 0.0618, 'grad_norm': 0.525515079498291, 'learning_rate': 2.2930371799975594e-06, 'epoch': 9.13}

 92%|█████████████████████████████████████████████████████████████████▎     | 855/930 [06:48<00:39,  1.92it/s]

 92%|█████████████████████████████████████████████████████████████████▋     | 860/930 [06:50<00:30,  2.29it/s]

 93%|█████████████████████████████████████████████████████████████████▋     | 861/930 [06:52<00:58,  1.18it/s]

 93%|██████████████████████████████████████████████████████████████████     | 866/930 [06:54<00:31,  2.06it/s]
{'loss': 0.062, 'grad_norm': 0.47785311937332153, 'learning_rate': 1.5263517088103863e-06, 'epoch': 9.29}

 94%|██████████████████████████████████████████████████████████████████▍    | 871/930 [06:56<00:24,  2.37it/s]

 94%|██████████████████████████████████████████████████████████████████▉    | 876/930 [06:58<00:21,  2.51it/s]
{'loss': 0.0637, 'grad_norm': 0.5387483239173889, 'learning_rate': 1.1399383862592927e-06, 'epoch': 9.39}

 95%|███████████████████████████████████████████████████████████████████▎   | 881/930 [07:00<00:19,  2.54it/s]
{'loss': 0.1099, 'grad_norm': 0.5192945003509521, 'learning_rate': 9.132772435510362e-07, 'epoch': 9.45}

 95%|███████████████████████████████████████████████████████████████████▌   | 885/930 [07:01<00:17,  2.56it/s]

 96%|████████████████████████████████████████████████████████████████████   | 891/930 [07:04<00:14,  2.60it/s]
{'loss': 0.0574, 'grad_norm': 0.5027073621749878, 'learning_rate': 6.199945009349173e-07, 'epoch': 9.55}

 96%|████████████████████████████████████████████████████████████████████▍  | 896/930 [07:06<00:13,  2.47it/s]
{'loss': 0.0561, 'grad_norm': 0.6647935509681702, 'learning_rate': 4.55756592088058e-07, 'epoch': 9.61}

 97%|████████████████████████████████████████████████████████████████████▊  | 901/930 [07:08<00:11,  2.47it/s]

 97%|█████████████████████████████████████████████████████████████████████▏ | 906/930 [07:10<00:09,  2.47it/s]
{'loss': 0.1084, 'grad_norm': 0.6349360346794128, 'learning_rate': 2.5653383040524227e-07, 'epoch': 9.71}

 98%|█████████████████████████████████████████████████████████████████████▌ | 911/930 [07:12<00:07,  2.53it/s]
{'loss': 0.055, 'grad_norm': 0.5196112394332886, 'learning_rate': 1.5523961862564106e-07, 'epoch': 9.77}

 98%|█████████████████████████████████████████████████████████████████████▉ | 916/930 [07:14<00:06,  2.22it/s]

 99%|██████████████████████████████████████████████████████████████████████▏| 920/930 [07:16<00:05,  1.95it/s]

 99%|██████████████████████████████████████████████████████████████████████▌| 924/930 [07:18<00:02,  2.34it/s]
{'loss': 0.0595, 'grad_norm': 0.5172142386436462, 'learning_rate': 2.8525453514099965e-08, 'epoch': 9.9}
100%|███████████████████████████████████████████████████████████████████████| 930/930 [07:19<00:00,  2.79it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32
  8%|██████▏                                                                   | 2/24 [00:00<00:01, 11.45it/s]
{'loss': 0.0774, 'grad_norm': 0.6435293555259705, 'learning_rate': 3.1697627597970793e-09, 'epoch': 9.97}


 92%|██████████████████████████████████████████████████████████████████▉      | 22/24 [00:04<00:00,  5.15it/s]
Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-930/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-930/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-930/preprocessor_config.json
Deleting older checkpoint [checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-744] due to args.save_total_limit
Training completed. Do not forget to share your model on huggingface.co/models =)
Loading best model from ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/checkpoint-837 (score: 0.9512855209742895).
100%|███████████████████████████████████████████████████████████████████████| 930/930 [07:25<00:00,  2.09it/s]
***** Running Evaluation *****
  Num examples = 739
  Batch size = 32
 25%|██████████████████▌                                                       | 6/24 [00:00<00:02,  6.19it/s]

100%|█████████████████████████████████████████████████████████████████████████| 24/24 [00:03<00:00,  6.03it/s]
Saving model checkpoint to ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50
Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-50/preprocessor_config.json

  1%|▊                                                                        | 5/465 [00:03<04:27,  1.72it/s]

  2%|█▍                                                                       | 9/465 [00:05<04:02,  1.88it/s]
{'loss': 3.5301, 'grad_norm': 3.971649408340454, 'learning_rate': 0.0002998767751969338, 'epoch': 0.06}

  3%|██▏                                                                     | 14/465 [00:07<03:15,  2.31it/s]

  3%|██▍                                                                     | 16/465 [00:08<03:15,  2.29it/s]

  4%|██▊                                                                     | 18/465 [00:11<07:05,  1.05it/s]

  5%|███▎                                                                    | 21/465 [00:13<05:02,  1.47it/s]

  6%|████                                                                    | 26/465 [00:15<03:42,  1.97it/s]

  6%|████▋                                                                   | 30/465 [00:17<03:18,  2.19it/s]
{'loss': 2.2764, 'grad_norm': 3.5393130779266357, 'learning_rate': 0.0002975112686093419, 'epoch': 0.29}

  8%|█████▍                                                                  | 35/465 [00:19<02:59,  2.40it/s]

  9%|██████▏                                                                 | 40/465 [00:21<02:56,  2.40it/s]
{'loss': 1.7584, 'grad_norm': 3.0581741333007812, 'learning_rate': 0.0002955851279565902, 'epoch': 0.39}

 10%|██████▉                                                                 | 45/465 [00:23<02:53,  2.42it/s]
{'loss': 1.4944, 'grad_norm': 2.8603808879852295, 'learning_rate': 0.00029400156874234885, 'epoch': 0.45}

 11%|███████▌                                                                | 49/465 [00:25<02:56,  2.35it/s]

 11%|████████▏                                                               | 53/465 [00:27<03:24,  2.01it/s]

 12%|████████▊                                                               | 57/465 [00:29<03:52,  1.76it/s]
{'loss': 1.0554, 'grad_norm': 2.4710915088653564, 'learning_rate': 0.00029012765822316553, 'epoch': 0.58}

 13%|█████████▎                                                              | 60/465 [00:31<03:13,  2.10it/s]

 14%|██████████                                                              | 65/465 [00:33<03:08,  2.12it/s]
{'loss': 0.9465, 'grad_norm': 1.9407000541687012, 'learning_rate': 0.00028661650055831643, 'epoch': 0.68}

 15%|██████████▋                                                             | 69/465 [00:35<02:49,  2.34it/s]

 16%|███████████▍                                                            | 74/465 [00:37<02:41,  2.42it/s]
{'loss': 0.7143, 'grad_norm': 1.5756981372833252, 'learning_rate': 0.0002826003930951567, 'epoch': 0.77}

 17%|████████████▏                                                           | 79/465 [00:39<02:42,  2.37it/s]

 18%|█████████████                                                           | 84/465 [00:41<02:35,  2.45it/s]
{'loss': 0.6749, 'grad_norm': 1.8910187482833862, 'learning_rate': 0.0002780941798140638, 'epoch': 0.87}

 19%|█████████████▊                                                          | 89/465 [00:43<02:34,  2.44it/s]
{'loss': 0.5655, 'grad_norm': 1.4505192041397095, 'learning_rate': 0.00027482590880535353, 'epoch': 0.94}
 20%|██████████████▍                                                         | 93/465 [00:44<02:12,  2.80it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 8
 20%|██████████████▉                                                          | 19/93 [00:00<00:04, 18.43it/s]


Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-16/checkpoint-93/config.json
{'eval_loss': 0.5111019611358643, 'eval_accuracy': 0.912043301759134, 'eval_runtime': 4.547, 'eval_samples_per_second': 162.524, 'eval_steps_per_second': 20.453, 'epoch': 1.0}
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-16/checkpoint-93/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-16/checkpoint-93/preprocessor_config.json
 21%|███████████████                                                         | 97/465 [00:51<05:15,  1.17it/s]

 22%|███████████████▌                                                       | 102/465 [00:53<02:59,  2.02it/s]
{'loss': 0.4688, 'grad_norm': 1.802260398864746, 'learning_rate': 0.0002676798075875126, 'epoch': 1.06}

 23%|████████████████▎                                                      | 107/465 [00:55<02:32,  2.35it/s]
{'loss': 0.4926, 'grad_norm': 1.3820478916168213, 'learning_rate': 0.0002638137184039186, 'epoch': 1.13}

 24%|████████████████▉                                                      | 111/465 [00:57<02:29,  2.37it/s]

 25%|█████████████████▋                                                     | 116/465 [00:59<02:25,  2.40it/s]
{'loss': 0.4575, 'grad_norm': 1.518325924873352, 'learning_rate': 0.0002576660370995218, 'epoch': 1.23}

 26%|██████████████████▍                                                    | 121/465 [01:01<02:20,  2.45it/s]

 27%|███████████████████▏                                                   | 126/465 [01:03<02:19,  2.44it/s]
{'loss': 0.3596, 'grad_norm': 1.4124526977539062, 'learning_rate': 0.00025112041013339206, 'epoch': 1.32}

 28%|████████████████████                                                   | 131/465 [01:05<02:22,  2.35it/s]

 29%|████████████████████▌                                                  | 135/465 [01:07<02:15,  2.43it/s]
{'loss': 0.3542, 'grad_norm': 1.4347021579742432, 'learning_rate': 0.0002442010308716519, 'epoch': 1.42}

 30%|█████████████████████▍                                                 | 140/465 [01:09<02:29,  2.18it/s]

 31%|█████████████████████▉                                                 | 144/465 [01:11<02:38,  2.03it/s]
{'loss': 0.3907, 'grad_norm': 1.2055305242538452, 'learning_rate': 0.00023693347411052546, 'epoch': 1.52}

 32%|██████████████████████▌                                                | 148/465 [01:13<02:39,  1.99it/s]

 33%|███████████████████████▏                                               | 152/465 [01:15<02:31,  2.07it/s]

 34%|███████████████████████▉                                               | 157/465 [01:17<02:09,  2.39it/s]
{'loss': 0.3635, 'grad_norm': 1.2160950899124146, 'learning_rate': 0.00022674838963853734, 'epoch': 1.65}

 35%|████████████████████████▋                                              | 162/465 [01:19<02:05,  2.42it/s]
{'loss': 0.3767, 'grad_norm': 1.067267656326294, 'learning_rate': 0.00022146246250521673, 'epoch': 1.71}

 36%|█████████████████████████▎                                             | 166/465 [01:21<02:29,  2.00it/s]

 37%|█████████████████████████▉                                             | 170/465 [01:23<02:18,  2.14it/s]

 38%|██████████████████████████▋                                            | 175/465 [01:25<02:03,  2.36it/s]
{'loss': 0.3413, 'grad_norm': 1.4172019958496094, 'learning_rate': 0.0002105472479968792, 'epoch': 1.84}

 38%|███████████████████████████▏                                           | 178/465 [01:27<02:21,  2.03it/s]

 39%|███████████████████████████▉                                           | 183/465 [01:29<01:59,  2.36it/s]
{'loss': 0.3619, 'grad_norm': 1.5081892013549805, 'learning_rate': 0.000202095787926723, 'epoch': 1.94}
 40%|████████████████████████████▍                                          | 186/465 [01:30<01:43,  2.70it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 8
 33%|████████████████████████▎                                                | 31/93 [00:01<00:02, 21.85it/s]


Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-16/checkpoint-186/config.json
{'eval_loss': 0.2842887043952942, 'eval_accuracy': 0.945872801082544, 'eval_runtime': 5.0196, 'eval_samples_per_second': 147.222, 'eval_steps_per_second': 18.527, 'epoch': 2.0}
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-16/checkpoint-186/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-16/checkpoint-186/preprocessor_config.json
 41%|████████████████████████████▊                                          | 189/465 [01:37<05:09,  1.12s/it]

 42%|█████████████████████████████▌                                         | 194/465 [01:39<02:31,  1.78it/s]

 43%|██████████████████████████████▍                                        | 199/465 [01:41<01:54,  2.32it/s]
{'loss': 0.3729, 'grad_norm': 1.052467942237854, 'learning_rate': 0.00018759787983880805, 'epoch': 2.1}

 44%|███████████████████████████████▏                                       | 204/465 [01:44<01:46,  2.45it/s]
{'loss': 0.3492, 'grad_norm': 1.1352458000183105, 'learning_rate': 0.0001816822104362411, 'epoch': 2.16}

 45%|███████████████████████████████▉                                       | 209/465 [01:46<01:47,  2.39it/s]

 46%|████████████████████████████████▋                                      | 214/465 [01:48<01:43,  2.43it/s]
{'loss': 0.2617, 'grad_norm': 1.0427775382995605, 'learning_rate': 0.0001727141666256865, 'epoch': 2.26}

 47%|█████████████████████████████████▎                                     | 218/465 [01:49<01:42,  2.42it/s]

 48%|██████████████████████████████████                                     | 223/465 [01:51<01:38,  2.47it/s]
{'loss': 0.3021, 'grad_norm': 1.142486333847046, 'learning_rate': 0.00016366216872606095, 'epoch': 2.35}

 49%|██████████████████████████████████▊                                    | 228/465 [01:54<01:39,  2.38it/s]

 50%|███████████████████████████████████▌                                   | 233/465 [01:56<01:35,  2.43it/s]
{'loss': 0.2654, 'grad_norm': 1.036615014076233, 'learning_rate': 0.00015455967392954143, 'epoch': 2.45}

 51%|████████████████████████████████████▎                                  | 238/465 [01:58<01:31,  2.47it/s]
{'loss': 0.2594, 'grad_norm': 1.1907567977905273, 'learning_rate': 0.00014847990054215837, 'epoch': 2.52}

 52%|████████████████████████████████████▊                                  | 241/465 [01:59<01:59,  1.88it/s]

 53%|█████████████████████████████████████▋                                 | 247/465 [02:02<01:31,  2.38it/s]
{'loss': 0.2727, 'grad_norm': 1.1047391891479492, 'learning_rate': 0.00013936804421536903, 'epoch': 2.61}

 54%|██████████████████████████████████████▎                                | 251/465 [02:03<01:29,  2.40it/s]

 55%|██████████████████████████████████████▉                                | 255/465 [02:05<01:29,  2.34it/s]
{'loss': 0.2363, 'grad_norm': 1.1754809617996216, 'learning_rate': 0.000130295484781028, 'epoch': 2.71}

 56%|███████████████████████████████████████▋                               | 260/465 [02:07<01:30,  2.28it/s]

 57%|████████████████████████████████████████▍                              | 265/465 [02:09<01:21,  2.46it/s]
{'loss': 0.2188, 'grad_norm': 0.8413528800010681, 'learning_rate': 0.00012129575542903405, 'epoch': 2.81}

 58%|████████████████████████████████████████▉                              | 268/465 [02:11<01:21,  2.42it/s]


 59%|█████████████████████████████████████████▊                             | 274/465 [02:15<01:41,  1.87it/s]
{'loss': 0.2536, 'grad_norm': 0.8929651379585266, 'learning_rate': 0.0001124021201611919, 'epoch': 2.9}
 60%|██████████████████████████████████████████▌                            | 279/465 [02:17<01:11,  2.59it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 8
 11%|███████▊                                                                 | 10/93 [00:00<00:06, 12.18it/s]
{'loss': 0.2404, 'grad_norm': 1.0467898845672607, 'learning_rate': 0.00010654822397647618, 'epoch': 2.97}


Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-16/checkpoint-279/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-16/checkpoint-279/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-16/checkpoint-279/preprocessor_config.json
Deleting older checkpoint [checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-16/checkpoint-93] due to args.save_total_limit
{'eval_loss': 0.24314366281032562, 'eval_accuracy': 0.9445196211096076, 'eval_runtime': 6.0439, 'eval_samples_per_second': 122.272, 'eval_steps_per_second': 15.387, 'epoch': 3.0}

 62%|███████████████████████████████████████████▋                           | 286/465 [02:28<02:12,  1.35it/s]
{'loss': 0.2153, 'grad_norm': 0.940652072429657, 'learning_rate': 0.00010076571894567204, 'epoch': 3.03}

 62%|████████████████████████████████████████████▎                          | 290/465 [02:29<01:26,  2.02it/s]

 63%|█████████████████████████████████████████████                          | 295/465 [02:32<01:15,  2.26it/s]
{'loss': 0.2554, 'grad_norm': 1.0654706954956055, 'learning_rate': 9.224656654556729e-05, 'epoch': 3.13}

 65%|█████████████████████████████████████████████▊                         | 300/465 [02:34<01:07,  2.45it/s]

 66%|██████████████████████████████████████████████▌                        | 305/465 [02:36<01:09,  2.30it/s]
{'loss': 0.2009, 'grad_norm': 0.8626685738563538, 'learning_rate': 8.394087726635483e-05, 'epoch': 3.23}

 67%|███████████████████████████████████████████████▎                       | 310/465 [02:38<01:04,  2.41it/s]
{'loss': 0.2408, 'grad_norm': 0.7748169302940369, 'learning_rate': 7.853753749478327e-05, 'epoch': 3.29}

 67%|███████████████████████████████████████████████▊                       | 313/465 [02:39<01:02,  2.42it/s]

 68%|████████████████████████████████████████████████▌                      | 318/465 [02:41<01:01,  2.40it/s]
{'loss': 0.2069, 'grad_norm': 0.9201659560203552, 'learning_rate': 7.065539845095567e-05, 'epoch': 3.39}

 69%|█████████████████████████████████████████████████▎                     | 323/465 [02:43<00:59,  2.38it/s]

 71%|██████████████████████████████████████████████████                     | 328/465 [02:45<00:57,  2.40it/s]
{'loss': 0.1939, 'grad_norm': 0.8467416763305664, 'learning_rate': 6.306652588947453e-05, 'epoch': 3.48}

 71%|██████████████████████████████████████████████████▋                    | 332/465 [02:47<00:57,  2.30it/s]
{'loss': 0.2474, 'grad_norm': 0.9851948618888855, 'learning_rate': 5.818410261785056e-05, 'epoch': 3.55}

 72%|███████████████████████████████████████████████████▍                   | 337/465 [02:49<00:53,  2.38it/s]

 74%|████████████████████████████████████████████████████▏                  | 342/465 [02:51<00:50,  2.43it/s]
{'loss': 0.2231, 'grad_norm': 1.082870364189148, 'learning_rate': 5.114575700266023e-05, 'epoch': 3.65}

 75%|████████████████████████████████████████████████████▉                  | 347/465 [02:54<00:52,  2.24it/s]

 75%|█████████████████████████████████████████████████████▌                 | 351/465 [02:55<00:48,  2.35it/s]
{'loss': 0.2334, 'grad_norm': 0.9147130846977234, 'learning_rate': 4.4472787677007776e-05, 'epoch': 3.74}

 77%|██████████████████████████████████████████████████████▎                | 356/465 [02:57<00:45,  2.42it/s]

 78%|███████████████████████████████████████████████████████                | 361/465 [02:59<00:44,  2.36it/s]
{'loss': 0.2128, 'grad_norm': 0.8024670481681824, 'learning_rate': 3.818985867855606e-05, 'epoch': 3.84}

 79%|███████████████████████████████████████████████████████▉               | 366/465 [03:01<00:41,  2.40it/s]
{'loss': 0.275, 'grad_norm': 1.2968140840530396, 'learning_rate': 3.422945822523569e-05, 'epoch': 3.9}
 80%|████████████████████████████████████████████████████████▊              | 372/465 [03:03<00:33,  2.78it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 8
  3%|██▍                                                                       | 3/93 [00:00<00:03, 23.02it/s]
{'loss': 0.2169, 'grad_norm': 0.8596137166023254, 'learning_rate': 3.0459268468062764e-05, 'epoch': 3.97}


Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-16/checkpoint-372/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-16/checkpoint-372/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-16/checkpoint-372/preprocessor_config.json
Deleting older checkpoint [checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-16/checkpoint-186] due to args.save_total_limit
{'eval_loss': 0.2286207228899002, 'eval_accuracy': 0.9485791610284168, 'eval_runtime': 5.313, 'eval_samples_per_second': 139.092, 'eval_steps_per_second': 17.504, 'epoch': 4.0}
 81%|█████████████████████████████████████████████████████████▌             | 377/465 [03:12<01:10,  1.25it/s]

 82%|██████████████████████████████████████████████████████████▏            | 381/465 [03:13<00:42,  1.97it/s]
{'loss': 0.266, 'grad_norm': 1.1044989824295044, 'learning_rate': 2.5174091194646435e-05, 'epoch': 4.06}

 83%|██████████████████████████████████████████████████████████▋            | 384/465 [03:15<00:36,  2.19it/s]

 84%|███████████████████████████████████████████████████████████▋           | 391/465 [03:17<00:30,  2.39it/s]

 85%|████████████████████████████████████████████████████████████▍          | 396/465 [03:20<00:28,  2.42it/s]
{'loss': 0.2429, 'grad_norm': 1.04468834400177, 'learning_rate': 1.7399606904843222e-05, 'epoch': 4.23}

 86%|█████████████████████████████████████████████████████████████▏         | 401/465 [03:22<00:25,  2.48it/s]

 87%|█████████████████████████████████████████████████████████████▉         | 406/465 [03:24<00:23,  2.49it/s]
{'loss': 0.2098, 'grad_norm': 0.8064303994178772, 'learning_rate': 1.3383499441683537e-05, 'epoch': 4.32}

 88%|██████████████████████████████████████████████████████████████▌        | 410/465 [03:25<00:25,  2.14it/s]

 89%|███████████████████████████████████████████████████████████████▎       | 415/465 [03:27<00:20,  2.39it/s]
{'loss': 0.2517, 'grad_norm': 1.207078456878662, 'learning_rate': 9.872341776834442e-06, 'epoch': 4.42}

 90%|███████████████████████████████████████████████████████████████▉       | 419/465 [03:29<00:18,  2.46it/s]

 91%|████████████████████████████████████████████████████████████████▉      | 425/465 [03:32<00:16,  2.36it/s]
{'loss': 0.1889, 'grad_norm': 0.731772243976593, 'learning_rate': 6.879111539992676e-06, 'epoch': 4.52}

 92%|█████████████████████████████████████████████████████████████████▋     | 430/465 [03:34<00:14,  2.37it/s]
{'loss': 0.2228, 'grad_norm': 0.9213733673095703, 'learning_rate': 5.176905600195968e-06, 'epoch': 4.58}

 93%|██████████████████████████████████████████████████████████████████▎    | 434/465 [03:35<00:13,  2.36it/s]

 94%|███████████████████████████████████████████████████████████████████    | 439/465 [03:37<00:10,  2.46it/s]
{'loss': 0.2238, 'grad_norm': 0.9248205423355103, 'learning_rate': 3.070508812125827e-06, 'epoch': 4.68}

 95%|███████████████████████████████████████████████████████████████████▊   | 444/465 [03:40<00:08,  2.39it/s]
{'loss': 0.2069, 'grad_norm': 0.9111302495002747, 'learning_rate': 1.9675503490583887e-06, 'epoch': 4.74}

 97%|████████████████████████████████████████████████████████████████████▌  | 449/465 [03:42<00:06,  2.45it/s]

 98%|█████████████████████████████████████████████████████████████████████▎ | 454/465 [03:44<00:04,  2.41it/s]
{'loss': 0.1769, 'grad_norm': 0.9913384318351746, 'learning_rate': 7.696014912157267e-07, 'epoch': 4.84}

 98%|█████████████████████████████████████████████████████████████████████▉ | 458/465 [03:45<00:02,  2.38it/s]
100%|███████████████████████████████████████████████████████████████████████| 465/465 [03:48<00:00,  2.82it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 8
  0%|                                                                                  | 0/93 [00:00<?, ?it/s]
{'loss': 0.2137, 'grad_norm': 0.8960126638412476, 'learning_rate': 1.2322480306615202e-07, 'epoch': 4.94}
{'loss': 0.2106, 'grad_norm': 1.0885990858078003, 'learning_rate': 3.080936482307561e-08, 'epoch': 4.97}


Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-16/checkpoint-465/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-16/checkpoint-465/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-16/checkpoint-465/preprocessor_config.json
Deleting older checkpoint [checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-16/checkpoint-279] due to args.save_total_limit
Training completed. Do not forget to share your model on huggingface.co/models =)
Loading best model from ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-16/checkpoint-465 (score: 0.22703112661838531).
100%|███████████████████████████████████████████████████████████████████████| 465/465 [03:53<00:00,  1.99it/s]
***** Running Evaluation *****
  Num examples = 739
  Batch size = 8
 14%|██████████▏                                                              | 13/93 [00:00<00:03, 20.37it/s]
{'eval_loss': 0.22703112661838531, 'eval_accuracy': 0.9472259810554804, 'eval_runtime': 4.862, 'eval_samples_per_second': 151.994, 'eval_steps_per_second': 19.128, 'epoch': 5.0}


100%|█████████████████████████████████████████████████████████████████████████| 93/93 [00:05<00:00, 16.81it/s]
Saving model checkpoint to ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-16
Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-16/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-16/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-16/preprocessor_config.json

  1%|▍                                                                        | 5/930 [00:03<07:54,  1.95it/s]
{'loss': 3.7049, 'grad_norm': 4.289669513702393, 'learning_rate': 1.6129032258064516e-06, 'epoch': 0.03}

  1%|▋                                                                        | 9/930 [00:04<07:10,  2.14it/s]
{'loss': 3.6675, 'grad_norm': 4.367244720458984, 'learning_rate': 4.838709677419355e-06, 'epoch': 0.1}

  2%|█                                                                       | 14/930 [00:06<06:19,  2.42it/s]

  2%|█▍                                                                      | 18/930 [00:08<07:07,  2.13it/s]

  2%|█▋                                                                      | 22/930 [00:11<08:09,  1.85it/s]

  3%|██                                                                      | 27/930 [00:13<06:33,  2.29it/s]
{'loss': 3.6878, 'grad_norm': 3.940250873565674, 'learning_rate': 1.2903225806451613e-05, 'epoch': 0.26}

  3%|██▍                                                                     | 31/930 [00:14<06:49,  2.20it/s]

  4%|██▋                                                                     | 35/930 [00:17<07:35,  1.96it/s]
{'loss': 3.6432, 'grad_norm': 3.8734638690948486, 'learning_rate': 1.774193548387097e-05, 'epoch': 0.35}

  4%|███                                                                     | 39/930 [00:19<08:02,  1.85it/s]


  5%|███▋                                                                    | 47/930 [00:22<06:14,  2.36it/s]
{'loss': 3.5854, 'grad_norm': 3.907353639602661, 'learning_rate': 2.258064516129032e-05, 'epoch': 0.45}
{'loss': 3.5684, 'grad_norm': 3.6619110107421875, 'learning_rate': 2.4193548387096777e-05, 'epoch': 0.48}

  5%|███▉                                                                    | 51/930 [00:24<07:08,  2.05it/s]

  6%|████▎                                                                   | 55/930 [00:26<07:36,  1.92it/s]

  6%|████▍                                                                   | 58/930 [00:28<07:14,  2.01it/s]

  7%|████▊                                                                   | 62/930 [00:31<08:25,  1.72it/s]
{'loss': 3.4633, 'grad_norm': 3.785529136657715, 'learning_rate': 3.2258064516129034e-05, 'epoch': 0.65}

  7%|█████                                                                   | 66/930 [00:32<07:03,  2.04it/s]


  8%|█████▍                                                                  | 71/930 [00:37<10:44,  1.33it/s]
{'loss': 3.3897, 'grad_norm': 4.094424247741699, 'learning_rate': 3.7096774193548386e-05, 'epoch': 0.74}

  8%|█████▉                                                                  | 76/930 [00:39<06:43,  2.12it/s]

  9%|██████▏                                                                 | 80/930 [00:41<06:19,  2.24it/s]
{'loss': 3.3486, 'grad_norm': 3.82639479637146, 'learning_rate': 4.1935483870967746e-05, 'epoch': 0.84}

  9%|██████▌                                                                 | 85/930 [00:43<06:01,  2.34it/s]

  9%|██████▊                                                                 | 88/930 [00:44<05:47,  2.43it/s]
{'loss': 3.2749, 'grad_norm': 3.7892913818359375, 'learning_rate': 4.67741935483871e-05, 'epoch': 0.94}
 10%|███████▏                                                                | 93/930 [00:46<06:29,  2.15it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32
  8%|██████▏                                                                   | 2/24 [00:00<00:02,  8.92it/s]


 83%|████████████████████████████████████████████████████████████▊            | 20/24 [00:04<00:00,  4.73it/s]
Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-93/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-93/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-93/preprocessor_config.json
 10%|███████▎                                                                | 94/930 [00:53<24:04,  1.73s/it]

 11%|███████▋                                                                | 99/930 [00:55<09:21,  1.48it/s]

 11%|███████▉                                                               | 104/930 [00:57<06:52,  2.00it/s]

 12%|████████▏                                                              | 108/930 [00:59<07:10,  1.91it/s]
{'loss': 3.0357, 'grad_norm': 3.830064535140991, 'learning_rate': 4.997464591667619e-05, 'epoch': 1.13}

 12%|████████▌                                                              | 112/930 [01:01<06:30,  2.09it/s]

 12%|████████▊                                                              | 116/930 [01:03<06:27,  2.10it/s]
{'loss': 2.9657, 'grad_norm': 4.078122615814209, 'learning_rate': 4.992238019068718e-05, 'epoch': 1.23}

 13%|█████████▏                                                             | 120/930 [01:05<06:51,  1.97it/s]

 13%|█████████▍                                                             | 124/930 [01:07<06:52,  1.95it/s]

 14%|█████████▊                                                             | 129/930 [01:09<05:58,  2.23it/s]
{'loss': 2.8565, 'grad_norm': 3.8602240085601807, 'learning_rate': 4.980847237981281e-05, 'epoch': 1.35}

 14%|██████████▏                                                            | 134/930 [01:11<05:15,  2.52it/s]
{'loss': 2.7726, 'grad_norm': 4.002321720123291, 'learning_rate': 4.97326301581448e-05, 'epoch': 1.42}

 15%|██████████▌                                                            | 139/930 [01:13<05:07,  2.57it/s]

 15%|██████████▉                                                            | 144/930 [01:15<04:59,  2.62it/s]
{'loss': 2.6409, 'grad_norm': 3.7448859214782715, 'learning_rate': 4.9595362359820727e-05, 'epoch': 1.52}

 16%|███████████▍                                                           | 149/930 [01:17<05:18,  2.45it/s]
{'loss': 2.6251, 'grad_norm': 3.7504708766937256, 'learning_rate': 4.948824853131236e-05, 'epoch': 1.58}

 17%|███████████▊                                                           | 154/930 [01:19<05:04,  2.55it/s]

 17%|████████████▏                                                          | 159/930 [01:21<05:17,  2.42it/s]
{'loss': 2.5716, 'grad_norm': 3.6597421169281006, 'learning_rate': 4.930431064394977e-05, 'epoch': 1.68}

 18%|████████████▌                                                          | 164/930 [01:23<05:03,  2.52it/s]
{'loss': 2.4992, 'grad_norm': 3.8958771228790283, 'learning_rate': 4.916626464793616e-05, 'epoch': 1.74}

 18%|████████████▉                                                          | 169/930 [01:25<04:52,  2.60it/s]

 19%|█████████████▎                                                         | 175/930 [01:27<04:49,  2.61it/s]
{'loss': 2.3865, 'grad_norm': 3.5098869800567627, 'learning_rate': 4.8936239563165895e-05, 'epoch': 1.84}

 19%|█████████████▋                                                         | 179/930 [01:29<05:22,  2.33it/s]
{'loss': 2.3038, 'grad_norm': 3.7986016273498535, 'learning_rate': 4.876769886175396e-05, 'epoch': 1.9}
 20%|██████████████▏                                                        | 186/930 [01:31<04:17,  2.89it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32
{'loss': 2.2566, 'grad_norm': 3.4950902462005615, 'learning_rate': 4.858710446774951e-05, 'epoch': 1.97}
{'loss': 2.1458, 'grad_norm': 4.682962894439697, 'learning_rate': 4.849231551964771e-05, 'epoch': 2.0}

Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-186/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-186/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-186/preprocessor_config.json
{'eval_loss': 2.240612745285034, 'eval_accuracy': 0.6820027063599459, 'eval_runtime': 4.683, 'eval_samples_per_second': 157.805, 'eval_steps_per_second': 5.125, 'epoch': 2.0}
 20%|██████████████▌                                                        | 190/930 [01:39<12:21,  1.00s/it]

 21%|██████████████▉                                                        | 195/930 [01:41<06:06,  2.01it/s]
{'loss': 2.2008, 'grad_norm': 3.3735673427581787, 'learning_rate': 4.829381421141671e-05, 'epoch': 2.06}

 22%|███████████████▎                                                       | 201/930 [01:43<05:01,  2.42it/s]
{'loss': 2.1304, 'grad_norm': 3.4322683811187744, 'learning_rate': 4.808349953928184e-05, 'epoch': 2.13}


 23%|████████████████                                                       | 210/930 [01:47<04:46,  2.51it/s]
{'loss': 2.0607, 'grad_norm': 3.735243320465088, 'learning_rate': 4.78614781634806e-05, 'epoch': 2.19}
{'loss': 2.0882, 'grad_norm': 3.2162585258483887, 'learning_rate': 4.7746112417970766e-05, 'epoch': 2.23}

 23%|████████████████▎                                                      | 214/930 [01:49<05:58,  2.00it/s]

 23%|████████████████▋                                                      | 218/930 [01:51<05:35,  2.12it/s]

 24%|████████████████▉                                                      | 222/930 [01:53<05:36,  2.11it/s]
{'loss': 1.9795, 'grad_norm': 3.1567585468292236, 'learning_rate': 4.725596127020879e-05, 'epoch': 2.35}

 24%|█████████████████▎                                                     | 227/930 [01:55<05:31,  2.12it/s]

 25%|█████████████████▋                                                     | 231/930 [01:57<05:03,  2.30it/s]
{'loss': 1.905, 'grad_norm': 3.479295492172241, 'learning_rate': 4.685866540361456e-05, 'epoch': 2.45}

 25%|██████████████████                                                     | 236/930 [01:59<05:07,  2.26it/s]

 26%|██████████████████▍                                                    | 241/930 [02:01<04:33,  2.52it/s]
{'loss': 1.7808, 'grad_norm': 3.1508429050445557, 'learning_rate': 4.643642840326627e-05, 'epoch': 2.55}

 26%|██████████████████▊                                                    | 246/930 [02:03<04:25,  2.57it/s]
{'loss': 1.9066, 'grad_norm': 3.075183391571045, 'learning_rate': 4.6141317645621e-05, 'epoch': 2.61}

 27%|███████████████████▏                                                   | 251/930 [02:05<04:29,  2.52it/s]
{'loss': 1.7321, 'grad_norm': 3.228362798690796, 'learning_rate': 4.583548515402144e-05, 'epoch': 2.68}

 27%|███████████████████▍                                                   | 255/930 [02:07<05:09,  2.18it/s]

 28%|███████████████████▊                                                   | 259/930 [02:09<05:50,  1.91it/s]

 28%|████████████████████▏                                                  | 264/930 [02:11<05:03,  2.19it/s]
{'loss': 1.7041, 'grad_norm': 3.0295419692993164, 'learning_rate': 4.5192280734641626e-05, 'epoch': 2.81}

 29%|████████████████████▍                                                  | 268/930 [02:13<05:37,  1.96it/s]

 29%|████████████████████▊                                                  | 272/930 [02:15<05:24,  2.03it/s]

 30%|█████████████████████                                                  | 276/930 [02:17<05:03,  2.16it/s]
{'loss': 1.5432, 'grad_norm': 3.090693712234497, 'learning_rate': 4.45081197738023e-05, 'epoch': 2.94}
 30%|█████████████████████▎                                                 | 279/930 [02:18<04:12,  2.58it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32
 33%|████████████████████████▋                                                 | 8/24 [00:01<00:02,  5.76it/s]

Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-279/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-279/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-279/preprocessor_config.json
Deleting older checkpoint [checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-93] due to args.save_total_limit
{'eval_loss': 1.554653525352478, 'eval_accuracy': 0.8146143437077131, 'eval_runtime': 4.7027, 'eval_samples_per_second': 157.144, 'eval_steps_per_second': 5.103, 'epoch': 3.0}
 31%|█████████████████████▋                                                 | 284/930 [02:25<07:56,  1.36it/s]

 31%|██████████████████████                                                 | 289/930 [02:27<05:03,  2.11it/s]
{'loss': 1.5561, 'grad_norm': 3.0202808380126953, 'learning_rate': 4.378438997342409e-05, 'epoch': 3.06}

 32%|██████████████████████▍                                                | 294/930 [02:29<04:17,  2.47it/s]
{'loss': 1.486, 'grad_norm': 2.7910380363464355, 'learning_rate': 4.340814244127993e-05, 'epoch': 3.13}

 32%|██████████████████████▊                                                | 299/930 [02:31<04:19,  2.43it/s]

 33%|███████████████████████▏                                               | 304/930 [02:33<04:03,  2.57it/s]
{'loss': 1.3764, 'grad_norm': 2.8670876026153564, 'learning_rate': 4.282632779078051e-05, 'epoch': 3.23}

 33%|███████████████████████▌                                               | 309/930 [02:35<04:10,  2.48it/s]
{'loss': 1.4169, 'grad_norm': 2.6966347694396973, 'learning_rate': 4.242710932368998e-05, 'epoch': 3.29}


 34%|███████████████████████▉                                               | 314/930 [02:39<07:22,  1.39it/s]

 34%|████████████████████████▎                                              | 318/930 [02:41<04:57,  2.06it/s]
{'loss': 1.3276, 'grad_norm': 2.653198003768921, 'learning_rate': 4.181177470554401e-05, 'epoch': 3.39}

 35%|████████████████████████▋                                              | 324/930 [02:44<04:05,  2.47it/s]

 35%|█████████████████████████                                              | 328/930 [02:46<04:45,  2.11it/s]
{'loss': 1.2783, 'grad_norm': 2.4815187454223633, 'learning_rate': 4.1177257547483945e-05, 'epoch': 3.48}

 36%|█████████████████████████▎                                             | 332/930 [02:47<04:41,  2.12it/s]

 36%|█████████████████████████▋                                             | 337/930 [02:49<04:05,  2.42it/s]
{'loss': 1.2993, 'grad_norm': 2.636305570602417, 'learning_rate': 4.052428184509762e-05, 'epoch': 3.58}

 37%|██████████████████████████                                             | 342/930 [02:51<03:47,  2.59it/s]
{'loss': 1.2922, 'grad_norm': 2.5788676738739014, 'learning_rate': 4.007907705153699e-05, 'epoch': 3.65}

 37%|██████████████████████████▍                                            | 347/930 [02:53<03:54,  2.49it/s]

 38%|██████████████████████████▊                                            | 351/930 [02:55<03:58,  2.43it/s]
{'loss': 1.2212, 'grad_norm': 2.621371269226074, 'learning_rate': 3.9397002807730166e-05, 'epoch': 3.74}

 38%|███████████████████████████                                            | 355/930 [02:57<03:49,  2.51it/s]

 39%|███████████████████████████▍                                           | 360/930 [02:59<04:34,  2.08it/s]
{'loss': 1.1971, 'grad_norm': 2.370161533355713, 'learning_rate': 3.869850132254996e-05, 'epoch': 3.84}


 40%|████████████████████████████▏                                          | 369/930 [03:03<03:45,  2.48it/s]
{'loss': 1.1114, 'grad_norm': 2.5376665592193604, 'learning_rate': 3.822410025817406e-05, 'epoch': 3.9}
{'loss': 1.0679, 'grad_norm': 2.328702688217163, 'learning_rate': 3.798436959886219e-05, 'epoch': 3.94}
 40%|████████████████████████████▍                                          | 372/930 [03:04<03:20,  2.78it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32
 29%|█████████████████████▌                                                    | 7/24 [00:01<00:03,  5.64it/s]

Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-372/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-372/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-372/preprocessor_config.json
Deleting older checkpoint [checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-186] due to args.save_total_limit
 40%|████████████████████████████▍                                          | 373/930 [03:09<13:38,  1.47s/it]

 41%|████████████████████████████▊                                          | 377/930 [03:11<06:38,  1.39it/s]
{'loss': 1.0703, 'grad_norm': 2.224597930908203, 'learning_rate': 3.725542247391834e-05, 'epoch': 4.03}

 41%|█████████████████████████████▏                                         | 382/930 [03:13<04:16,  2.14it/s]

 42%|█████████████████████████████▍                                         | 386/930 [03:14<03:43,  2.44it/s]

 42%|█████████████████████████████▊                                         | 391/930 [03:17<04:01,  2.23it/s]
{'loss': 1.0849, 'grad_norm': 2.329394817352295, 'learning_rate': 3.626188668945683e-05, 'epoch': 4.16}

 43%|██████████████████████████████▏                                        | 396/930 [03:19<03:37,  2.46it/s]
{'loss': 1.112, 'grad_norm': 2.335012912750244, 'learning_rate': 3.575642494344365e-05, 'epoch': 4.23}

 43%|██████████████████████████████▌                                        | 401/930 [03:21<03:28,  2.53it/s]
{'loss': 1.0704, 'grad_norm': 2.3300890922546387, 'learning_rate': 3.5245508119914687e-05, 'epoch': 4.29}

 44%|██████████████████████████████▉                                        | 406/930 [03:23<03:19,  2.63it/s]

 44%|███████████████████████████████▍                                       | 411/930 [03:25<03:24,  2.54it/s]
{'loss': 1.0618, 'grad_norm': 2.375669240951538, 'learning_rate': 3.44694721402644e-05, 'epoch': 4.39}

 45%|███████████████████████████████▊                                       | 416/930 [03:27<03:21,  2.55it/s]
{'loss': 0.9798, 'grad_norm': 2.262472152709961, 'learning_rate': 3.3946056954647483e-05, 'epoch': 4.45}

 45%|████████████████████████████████▏                                      | 421/930 [03:29<03:43,  2.28it/s]

 46%|████████████████████████████████▍                                      | 425/930 [03:31<04:00,  2.10it/s]
{'loss': 0.9495, 'grad_norm': 2.1714439392089844, 'learning_rate': 3.315251096774737e-05, 'epoch': 4.55}

 46%|████████████████████████████████▊                                      | 429/930 [03:33<03:57,  2.11it/s]

 47%|█████████████████████████████████                                      | 433/930 [03:35<03:59,  2.08it/s]

 47%|█████████████████████████████████▍                                     | 438/930 [03:37<03:38,  2.25it/s]
{'loss': 0.9515, 'grad_norm': 2.225956439971924, 'learning_rate': 3.2080137667057595e-05, 'epoch': 4.68}

 48%|█████████████████████████████████▋                                     | 442/930 [03:39<04:12,  1.93it/s]

 48%|██████████████████████████████████                                     | 446/930 [03:41<03:59,  2.02it/s]

 48%|██████████████████████████████████▎                                    | 450/930 [03:43<03:57,  2.02it/s]
{'loss': 0.865, 'grad_norm': 2.0273523330688477, 'learning_rate': 3.099340353433946e-05, 'epoch': 4.81}

 49%|██████████████████████████████████▋                                    | 454/930 [03:45<03:49,  2.08it/s]

 49%|███████████████████████████████████                                    | 459/930 [03:47<03:14,  2.42it/s]
{'loss': 0.8987, 'grad_norm': 2.069115400314331, 'learning_rate': 3.0170253664617686e-05, 'epoch': 4.9}

 50%|███████████████████████████████████▎                                   | 463/930 [03:49<03:56,  1.97it/s]
{'loss': 0.8193, 'grad_norm': 2.0238230228424072, 'learning_rate': 2.961815140042974e-05, 'epoch': 4.97}
 50%|███████████████████████████████████▌                                   | 465/930 [03:50<03:22,  2.30it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32

Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-465/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-465/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-465/preprocessor_config.json
Deleting older checkpoint [checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-279] due to args.save_total_limit
{'eval_loss': 0.8909803628921509, 'eval_accuracy': 0.8863328822733424, 'eval_runtime': 4.8036, 'eval_samples_per_second': 153.844, 'eval_steps_per_second': 4.996, 'epoch': 5.0}
 50%|███████████████████████████████████▊                                   | 469/930 [03:57<07:30,  1.02it/s]

 51%|████████████████████████████████████                                   | 473/930 [03:59<04:57,  1.53it/s]

 51%|████████████████████████████████████▍                                  | 477/930 [04:01<03:40,  2.06it/s]
{'loss': 0.8514, 'grad_norm': 1.9385228157043457, 'learning_rate': 2.8507201825708994e-05, 'epoch': 5.1}

 52%|████████████████████████████████████▊                                  | 482/930 [04:03<03:19,  2.24it/s]

 52%|█████████████████████████████████████▏                                 | 487/930 [04:05<02:58,  2.48it/s]
{'loss': 0.8339, 'grad_norm': 1.9729849100112915, 'learning_rate': 2.7669197428838972e-05, 'epoch': 5.19}

 53%|█████████████████████████████████████▌                                 | 492/930 [04:07<02:51,  2.56it/s]
{'loss': 0.8515, 'grad_norm': 2.303138256072998, 'learning_rate': 2.7108776651076118e-05, 'epoch': 5.26}

 53%|█████████████████████████████████████▉                                 | 497/930 [04:09<02:46,  2.61it/s]
{'loss': 0.7768, 'grad_norm': 1.792599081993103, 'learning_rate': 2.654728641574205e-05, 'epoch': 5.32}

 54%|██████████████████████████████████████▎                                | 502/930 [04:11<02:54,  2.46it/s]

 55%|██████████████████████████████████████▋                                | 507/930 [04:13<02:41,  2.62it/s]
{'loss': 0.8526, 'grad_norm': 2.10321307182312, 'learning_rate': 2.570366884961263e-05, 'epoch': 5.42}

 55%|███████████████████████████████████████                                | 512/930 [04:15<02:44,  2.54it/s]
{'loss': 0.775, 'grad_norm': 2.1479594707489014, 'learning_rate': 2.514075161543915e-05, 'epoch': 5.48}

 56%|███████████████████████████████████████▌                               | 518/930 [04:17<02:41,  2.56it/s]

 56%|███████████████████████████████████████▉                               | 523/930 [04:19<02:36,  2.60it/s]
{'loss': 0.7273, 'grad_norm': 1.881629228591919, 'learning_rate': 2.429633115038737e-05, 'epoch': 5.58}

 57%|████████████████████████████████████████▏                              | 526/930 [04:21<03:20,  2.02it/s]

 57%|████████████████████████████████████████▌                              | 531/930 [04:24<03:11,  2.08it/s]
{'loss': 0.7575, 'grad_norm': 1.8991042375564575, 'learning_rate': 2.3452713584257955e-05, 'epoch': 5.68}

 58%|████████████████████████████████████████▉                              | 536/930 [04:26<02:44,  2.40it/s]

 58%|█████████████████████████████████████████▎                             | 541/930 [04:28<02:41,  2.40it/s]
{'loss': 0.7382, 'grad_norm': 1.7221601009368896, 'learning_rate': 2.261086149999755e-05, 'epoch': 5.77}

 59%|█████████████████████████████████████████▌                             | 545/930 [04:29<02:59,  2.15it/s]

 59%|█████████████████████████████████████████▉                             | 549/930 [04:31<02:56,  2.16it/s]
{'loss': 0.84, 'grad_norm': 2.222487449645996, 'learning_rate': 2.177173546610597e-05, 'epoch': 5.87}

 60%|██████████████████████████████████████████▎                            | 554/930 [04:34<02:53,  2.17it/s]
 60%|██████████████████████████████████████████▌                            | 558/930 [04:35<02:32,  2.44it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32
  8%|██████▏                                                                   | 2/24 [00:00<00:02,  9.29it/s]
{'loss': 0.7515, 'grad_norm': 2.368159294128418, 'learning_rate': 2.0936292940610094e-05, 'epoch': 5.97}


Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-558/config.json
{'eval_loss': 0.764906644821167, 'eval_accuracy': 0.8903924221921515, 'eval_runtime': 4.6112, 'eval_samples_per_second': 160.261, 'eval_steps_per_second': 5.205, 'epoch': 6.0}
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-558/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-558/preprocessor_config.json
Deleting older checkpoint [checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-372] due to args.save_total_limit

 61%|███████████████████████████████████████████                            | 564/930 [04:43<04:24,  1.38it/s]
{'loss': 0.7547, 'grad_norm': 1.9733303785324097, 'learning_rate': 2.0381848599570276e-05, 'epoch': 6.03}

 61%|███████████████████████████████████████████▍                           | 569/930 [04:46<02:50,  2.12it/s]

 62%|███████████████████████████████████████████▋                           | 573/930 [04:47<02:35,  2.30it/s]
{'loss': 0.7587, 'grad_norm': 1.7705272436141968, 'learning_rate': 1.9554661031278712e-05, 'epoch': 6.13}

 62%|████████████████████████████████████████████▏                          | 578/930 [04:50<02:29,  2.35it/s]

 63%|████████████████████████████████████████████▌                          | 583/930 [04:52<02:28,  2.34it/s]
{'loss': 0.7078, 'grad_norm': 1.783506155014038, 'learning_rate': 1.8733686693531985e-05, 'epoch': 6.23}

 63%|████████████████████████████████████████████▉                          | 588/930 [04:54<02:16,  2.51it/s]
{'loss': 0.662, 'grad_norm': 1.951204538345337, 'learning_rate': 1.8190285178095172e-05, 'epoch': 6.29}

 64%|█████████████████████████████████████████████▎                         | 593/930 [04:56<02:12,  2.54it/s]

 64%|█████████████████████████████████████████████▋                         | 598/930 [04:58<02:16,  2.43it/s]
{'loss': 0.7223, 'grad_norm': 1.7262784242630005, 'learning_rate': 1.738174389867366e-05, 'epoch': 6.39}

 65%|██████████████████████████████████████████████                         | 603/930 [05:00<02:09,  2.53it/s]
{'loss': 0.6989, 'grad_norm': 1.871155858039856, 'learning_rate': 1.6847489032252627e-05, 'epoch': 6.45}

 65%|██████████████████████████████████████████████▍                        | 608/930 [05:02<02:06,  2.55it/s]

 66%|██████████████████████████████████████████████▊                        | 613/930 [05:04<02:10,  2.44it/s]
{'loss': 0.7402, 'grad_norm': 1.815199613571167, 'learning_rate': 1.605394304535252e-05, 'epoch': 6.55}

 66%|███████████████████████████████████████████████▏                       | 618/930 [05:06<02:05,  2.48it/s]
{'loss': 0.7307, 'grad_norm': 1.7862880229949951, 'learning_rate': 1.55305278597356e-05, 'epoch': 6.61}

 67%|███████████████████████████████████████████████▌                       | 623/930 [05:08<02:00,  2.54it/s]

 67%|███████████████████████████████████████████████▊                       | 627/930 [05:10<02:25,  2.08it/s]
{'loss': 0.682, 'grad_norm': 1.7566441297531128, 'learning_rate': 1.475449188008532e-05, 'epoch': 6.71}

 68%|████████████████████████████████████████████████▏                      | 632/930 [05:12<02:00,  2.47it/s]

 68%|████████████████████████████████████████████████▋                      | 637/930 [05:14<01:55,  2.54it/s]
{'loss': 0.6539, 'grad_norm': 1.7192246913909912, 'learning_rate': 1.399014621105914e-05, 'epoch': 6.81}

 69%|████████████████████████████████████████████████▉                      | 641/930 [05:15<02:10,  2.22it/s]
{'loss': 0.6888, 'grad_norm': 1.8311803340911865, 'learning_rate': 1.3487508310388536e-05, 'epoch': 6.87}

 69%|█████████████████████████████████████████████████▎                     | 646/930 [05:18<02:01,  2.34it/s]
 70%|█████████████████████████████████████████████████▋                     | 651/930 [05:19<01:37,  2.85it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32
 17%|████████████▎                                                             | 4/24 [00:00<00:02,  6.94it/s]
{'loss': 0.668, 'grad_norm': 1.698067307472229, 'learning_rate': 1.2744577526081666e-05, 'epoch': 6.97}

Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-651/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-651/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-651/preprocessor_config.json
Deleting older checkpoint [checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-465] due to args.save_total_limit
{'eval_loss': 0.6991905570030212, 'eval_accuracy': 0.8944519621109608, 'eval_runtime': 4.4115, 'eval_samples_per_second': 167.515, 'eval_steps_per_second': 5.44, 'epoch': 7.0}
 70%|█████████████████████████████████████████████████▉                     | 654/930 [05:25<04:34,  1.00it/s]

 71%|██████████████████████████████████████████████████▎                    | 659/930 [05:27<02:21,  1.92it/s]
{'loss': 0.6986, 'grad_norm': 1.8841431140899658, 'learning_rate': 1.2015630401137812e-05, 'epoch': 7.06}

 71%|██████████████████████████████████████████████████▌                    | 663/930 [05:29<02:05,  2.12it/s]

 72%|██████████████████████████████████████████████████▉                    | 667/930 [05:31<02:14,  1.95it/s]

 72%|███████████████████████████████████████████████████▏                   | 671/930 [05:33<02:14,  1.92it/s]
{'loss': 0.6893, 'grad_norm': 1.8706092834472656, 'learning_rate': 1.1066888421939093e-05, 'epoch': 7.19}

 73%|███████████████████████████████████████████████████▌                   | 676/930 [05:35<01:45,  2.42it/s]

 73%|███████████████████████████████████████████████████▉                   | 681/930 [05:37<01:39,  2.51it/s]
{'loss': 0.679, 'grad_norm': 1.7533079385757446, 'learning_rate': 1.0373775035117305e-05, 'epoch': 7.29}

 74%|████████████████████████████████████████████████████▎                  | 686/930 [05:39<01:32,  2.63it/s]
{'loss': 0.6367, 'grad_norm': 1.6684837341308594, 'learning_rate': 9.92092294846301e-06, 'epoch': 7.35}

 74%|████████████████████████████████████████████████████▊                  | 691/930 [05:41<01:33,  2.56it/s]

 75%|█████████████████████████████████████████████████████▏                 | 696/930 [05:43<01:38,  2.38it/s]
{'loss': 0.6708, 'grad_norm': 1.6555593013763428, 'learning_rate': 9.256054205114939e-06, 'epoch': 7.45}

 75%|█████████████████████████████████████████████████████▌                 | 701/930 [05:45<01:29,  2.55it/s]
{'loss': 0.6348, 'grad_norm': 1.7052816152572632, 'learning_rate': 8.822742452516064e-06, 'epoch': 7.52}

 76%|█████████████████████████████████████████████████████▉                 | 706/930 [05:47<01:36,  2.32it/s]

 76%|██████████████████████████████████████████████████████▏                | 710/930 [05:49<01:41,  2.17it/s]
{'loss': 0.656, 'grad_norm': 1.6898012161254883, 'learning_rate': 8.188225294455992e-06, 'epoch': 7.61}

 77%|██████████████████████████████████████████████████████▌                | 715/930 [05:51<01:28,  2.44it/s]

 77%|██████████████████████████████████████████████████████▉                | 720/930 [05:53<01:21,  2.56it/s]
{'loss': 0.6193, 'grad_norm': 1.685259222984314, 'learning_rate': 7.572890676310026e-06, 'epoch': 7.71}

 78%|███████████████████████████████████████████████████████▎               | 725/930 [05:55<01:35,  2.15it/s]
{'loss': 0.6745, 'grad_norm': 1.8536014556884766, 'learning_rate': 7.173672209219495e-06, 'epoch': 7.77}

 78%|███████████████████████████████████████████████████████▋               | 729/930 [05:57<01:35,  2.10it/s]

 79%|████████████████████████████████████████████████████████               | 734/930 [05:59<01:19,  2.47it/s]
{'loss': 0.6376, 'grad_norm': 1.7828199863433838, 'learning_rate': 6.591857558720071e-06, 'epoch': 7.87}

 79%|████████████████████████████████████████████████████████▍              | 739/930 [06:01<01:18,  2.43it/s]
 80%|████████████████████████████████████████████████████████▊              | 744/930 [06:03<01:05,  2.82it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32
  8%|██████▏                                                                   | 2/24 [00:00<00:01, 11.46it/s]
{'loss': 0.6558, 'grad_norm': 1.6290303468704224, 'learning_rate': 6.031046932680229e-06, 'epoch': 7.97}


 88%|███████████████████████████████████████████████████████████████▉         | 21/24 [00:04<00:00,  4.22it/s]
Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-744/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-744/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-744/preprocessor_config.json
Deleting older checkpoint [checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-558] due to args.save_total_limit

 81%|█████████████████████████████████████████████████████████▏             | 749/930 [06:11<02:30,  1.20it/s]
{'loss': 0.6166, 'grad_norm': 1.7144100666046143, 'learning_rate': 5.669159090519019e-06, 'epoch': 8.03}

 81%|█████████████████████████████████████████████████████████▍             | 753/930 [06:13<01:45,  1.68it/s]

 81%|█████████████████████████████████████████████████████████▊             | 757/930 [06:15<01:28,  1.95it/s]

 82%|██████████████████████████████████████████████████████████             | 761/930 [06:17<01:28,  1.91it/s]
{'loss': 0.6724, 'grad_norm': 1.683365821838379, 'learning_rate': 4.9749726382653905e-06, 'epoch': 8.16}

 82%|██████████████████████████████████████████████████████████▍            | 766/930 [06:20<01:13,  2.22it/s]

 83%|██████████████████████████████████████████████████████████▊            | 771/930 [06:22<01:02,  2.53it/s]
{'loss': 0.6474, 'grad_norm': 1.8463653326034546, 'learning_rate': 4.480913969818098e-06, 'epoch': 8.26}

 83%|███████████████████████████████████████████████████████████▏           | 776/930 [06:24<00:59,  2.60it/s]
{'loss': 0.6291, 'grad_norm': 1.7564936876296997, 'learning_rate': 4.164514845978562e-06, 'epoch': 8.32}

 84%|███████████████████████████████████████████████████████████▌           | 781/930 [06:25<00:57,  2.58it/s]

 85%|████████████████████████████████████████████████████████████           | 786/930 [06:28<01:00,  2.38it/s]
{'loss': 0.6116, 'grad_norm': 1.7473903894424438, 'learning_rate': 3.70977727645363e-06, 'epoch': 8.42}

 85%|████████████████████████████████████████████████████████████▍          | 791/930 [06:30<00:55,  2.52it/s]

 86%|████████████████████████████████████████████████████████████▊          | 796/930 [06:31<00:52,  2.57it/s]
{'loss': 0.6315, 'grad_norm': 1.4784595966339111, 'learning_rate': 3.2793322372729085e-06, 'epoch': 8.52}

 86%|█████████████████████████████████████████████████████████████▏         | 801/930 [06:34<01:00,  2.12it/s]
{'loss': 0.6537, 'grad_norm': 1.8229361772537231, 'learning_rate': 3.0061084268410006e-06, 'epoch': 8.58}

 87%|█████████████████████████████████████████████████████████████▍         | 805/930 [06:36<00:59,  2.10it/s]

 87%|█████████████████████████████████████████████████████████████▊         | 809/930 [06:38<00:58,  2.07it/s]
{'loss': 0.6387, 'grad_norm': 1.6358911991119385, 'learning_rate': 2.617228430236521e-06, 'epoch': 8.68}

 87%|██████████████████████████████████████████████████████████████         | 813/930 [06:39<00:55,  2.10it/s]

 88%|██████████████████████████████████████████████████████████████▍        | 818/930 [06:41<00:44,  2.54it/s]

 88%|██████████████████████████████████████████████████████████████▊        | 823/930 [06:46<00:59,  1.79it/s]
{'loss': 0.6101, 'grad_norm': 1.7547833919525146, 'learning_rate': 2.138521836519408e-06, 'epoch': 8.81}

 89%|███████████████████████████████████████████████████████████████▏       | 828/930 [06:48<00:43,  2.36it/s]
{'loss': 0.5973, 'grad_norm': 1.5918291807174683, 'learning_rate': 1.9165004607181596e-06, 'epoch': 8.87}

 89%|███████████████████████████████████████████████████████████████▌       | 832/930 [06:50<00:48,  2.01it/s]
 90%|███████████████████████████████████████████████████████████████▉       | 837/930 [06:52<00:39,  2.34it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32
{'loss': 0.6067, 'grad_norm': 1.7203994989395142, 'learning_rate': 1.6054520311291093e-06, 'epoch': 8.97}
{'loss': 0.6361, 'grad_norm': 2.74609637260437, 'learning_rate': 1.5076844803522922e-06, 'epoch': 9.0}

Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-837/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-837/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-837/preprocessor_config.json
Deleting older checkpoint [checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-744] due to args.save_total_limit
 90%|███████████████████████████████████████████████████████████████▉       | 838/930 [06:58<02:36,  1.70s/it]

 90%|████████████████████████████████████████████████████████████████▏      | 841/930 [06:59<01:26,  1.03it/s]

 91%|████████████████████████████████████████████████████████████████▋      | 847/930 [07:02<00:38,  2.18it/s]
{'loss': 0.5901, 'grad_norm': 1.373525857925415, 'learning_rate': 1.3210972051628328e-06, 'epoch': 9.06}

 92%|████████████████████████████████████████████████████████████████▉      | 851/930 [07:04<00:36,  2.16it/s]
{'loss': 0.6537, 'grad_norm': 1.7819972038269043, 'learning_rate': 1.1465185899987797e-06, 'epoch': 9.13}

 92%|█████████████████████████████████████████████████████████████████▎     | 856/930 [07:06<00:30,  2.44it/s]

 93%|█████████████████████████████████████████████████████████████████▋     | 861/930 [07:08<00:26,  2.57it/s]
{'loss': 0.6304, 'grad_norm': 1.660302996635437, 'learning_rate': 9.073589027514789e-07, 'epoch': 9.23}

 93%|██████████████████████████████████████████████████████████████████     | 866/930 [07:10<00:26,  2.44it/s]
{'loss': 0.5919, 'grad_norm': 1.6205217838287354, 'learning_rate': 7.631758544051932e-07, 'epoch': 9.29}

 94%|██████████████████████████████████████████████████████████████████▍    | 871/930 [07:12<00:24,  2.37it/s]

 94%|██████████████████████████████████████████████████████████████████▊    | 875/930 [07:14<00:26,  2.08it/s]

 95%|███████████████████████████████████████████████████████████████████    | 879/930 [07:16<00:24,  2.06it/s]
{'loss': 0.6037, 'grad_norm': 1.6504004001617432, 'learning_rate': 5.117514686876379e-07, 'epoch': 9.42}

 95%|███████████████████████████████████████████████████████████████████▌   | 885/930 [07:18<00:17,  2.52it/s]
{'loss': 0.6529, 'grad_norm': 1.6427844762802124, 'learning_rate': 4.0463764017927565e-07, 'epoch': 9.48}

 96%|███████████████████████████████████████████████████████████████████▊   | 889/930 [07:20<00:16,  2.45it/s]

 96%|████████████████████████████████████████████████████████████████████▎  | 895/930 [07:22<00:13,  2.53it/s]
{'loss': 0.634, 'grad_norm': 1.7468409538269043, 'learning_rate': 2.6736984185520284e-07, 'epoch': 9.58}

 97%|████████████████████████████████████████████████████████████████████▋  | 899/930 [07:24<00:14,  2.14it/s]

 97%|████████████████████████████████████████████████████████████████████▉  | 903/930 [07:26<00:12,  2.10it/s]
{'loss': 0.5772, 'grad_norm': 1.8612771034240723, 'learning_rate': 1.5832242320543144e-07, 'epoch': 9.68}

 98%|█████████████████████████████████████████████████████████████████████▎ | 908/930 [07:28<00:09,  2.37it/s]

 98%|█████████████████████████████████████████████████████████████████████▋ | 912/930 [07:30<00:08,  2.23it/s]
{'loss': 0.6181, 'grad_norm': 1.8098464012145996, 'learning_rate': 7.761980931282053e-08, 'epoch': 9.77}

 99%|██████████████████████████████████████████████████████████████████████ | 918/930 [07:32<00:04,  2.54it/s]
{'loss': 0.6456, 'grad_norm': 1.7314202785491943, 'learning_rate': 3.961198799321275e-08, 'epoch': 9.84}

 99%|██████████████████████████████████████████████████████████████████████▍| 923/930 [07:34<00:02,  2.62it/s]

100%|██████████████████████████████████████████████████████████████████████▊| 928/930 [07:36<00:00,  2.31it/s]
{'loss': 0.5846, 'grad_norm': 1.6881589889526367, 'learning_rate': 6.339324571674743e-09, 'epoch': 9.94}
100%|███████████████████████████████████████████████████████████████████████| 930/930 [07:36<00:00,  2.62it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32
 25%|██████████████████▌                                                       | 6/24 [00:01<00:03,  4.71it/s]

Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-930/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-930/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-930/preprocessor_config.json
Deleting older checkpoint [checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-837] due to args.save_total_limit
Training completed. Do not forget to share your model on huggingface.co/models =)
Loading best model from ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/checkpoint-651 (score: 0.8944519621109608).
100%|███████████████████████████████████████████████████████████████████████| 930/930 [07:42<00:00,  2.01it/s]
***** Running Evaluation *****
  Num examples = 739
  Batch size = 32
  8%|██████▏                                                                   | 2/24 [00:00<00:01, 11.19it/s]
{'eval_loss': 0.6555558443069458, 'eval_accuracy': 0.8944519621109608, 'eval_runtime': 4.6065, 'eval_samples_per_second': 160.427, 'eval_steps_per_second': 5.21, 'epoch': 10.0}

100%|█████████████████████████████████████████████████████████████████████████| 24/24 [00:03<00:00,  6.19it/s]
Saving model checkpoint to ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25
Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-25/preprocessor_config.json

  1%|▍                                                                        | 5/930 [00:03<08:36,  1.79it/s]
{'loss': 3.727, 'grad_norm': 3.7562506198883057, 'learning_rate': 3.225806451612903e-06, 'epoch': 0.03}

  1%|▊                                                                       | 10/930 [00:05<06:43,  2.28it/s]
{'loss': 3.6429, 'grad_norm': 4.417624473571777, 'learning_rate': 9.67741935483871e-06, 'epoch': 0.1}

  2%|█▏                                                                      | 15/930 [00:07<06:24,  2.38it/s]

  2%|█▍                                                                      | 19/930 [00:09<06:26,  2.36it/s]
{'loss': 3.7157, 'grad_norm': 4.136293888092041, 'learning_rate': 1.935483870967742e-05, 'epoch': 0.19}

  3%|█▊                                                                      | 24/930 [00:11<06:20,  2.38it/s]

  3%|██▏                                                                     | 29/930 [00:13<06:00,  2.50it/s]
{'loss': 3.6541, 'grad_norm': 4.083168029785156, 'learning_rate': 2.9032258064516133e-05, 'epoch': 0.29}

  4%|██▋                                                                     | 34/930 [00:15<06:23,  2.34it/s]
{'loss': 3.6767, 'grad_norm': 3.9893064498901367, 'learning_rate': 3.548387096774194e-05, 'epoch': 0.35}

  4%|██▉                                                                     | 38/930 [00:17<06:12,  2.39it/s]

  5%|███▎                                                                    | 43/930 [00:19<06:04,  2.43it/s]

  5%|███▋                                                                    | 47/930 [00:21<07:41,  1.91it/s]
{'loss': 3.5695, 'grad_norm': 4.080042839050293, 'learning_rate': 4.8387096774193554e-05, 'epoch': 0.48}

  5%|███▉                                                                    | 51/930 [00:23<07:26,  1.97it/s]

  6%|████▏                                                                   | 54/930 [00:25<07:47,  1.87it/s]

  6%|████▍                                                                   | 58/930 [00:27<07:53,  1.84it/s]

  7%|████▊                                                                   | 62/930 [00:29<07:58,  1.81it/s]
{'loss': 3.3314, 'grad_norm': 3.6842780113220215, 'learning_rate': 6.451612903225807e-05, 'epoch': 0.65}

  7%|█████                                                                   | 66/930 [00:31<07:01,  2.05it/s]

  8%|█████▍                                                                  | 71/930 [00:33<06:13,  2.30it/s]
{'loss': 3.1357, 'grad_norm': 4.058384895324707, 'learning_rate': 7.419354838709677e-05, 'epoch': 0.74}

  8%|█████▊                                                                  | 75/930 [00:35<05:53,  2.42it/s]

  8%|██████                                                                  | 79/930 [00:37<07:11,  1.97it/s]

  9%|██████▍                                                                 | 83/930 [00:39<07:04,  2.00it/s]
{'loss': 2.9363, 'grad_norm': 3.9300456047058105, 'learning_rate': 8.709677419354839e-05, 'epoch': 0.87}

  9%|██████▋                                                                 | 87/930 [00:41<06:53,  2.04it/s]
 10%|███████▏                                                                | 93/930 [00:43<05:17,  2.64it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32
  0%|                                                                                  | 0/24 [00:00<?, ?it/s]
{'loss': 2.7339, 'grad_norm': 3.7954745292663574, 'learning_rate': 9.677419354838711e-05, 'epoch': 0.97}


 83%|████████████████████████████████████████████████████████████▊            | 20/24 [00:04<00:00,  4.14it/s]
Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-93/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-93/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-93/preprocessor_config.json

 10%|███████▌                                                                | 97/930 [00:51<13:55,  1.00s/it]
{'loss': 2.6671, 'grad_norm': 3.7804059982299805, 'learning_rate': 9.99968302372402e-05, 'epoch': 1.03}

 11%|███████▊                                                               | 102/930 [00:53<07:31,  1.83it/s]

 12%|████████▏                                                              | 107/930 [00:55<06:00,  2.28it/s]
{'loss': 2.4621, 'grad_norm': 3.703751802444458, 'learning_rate': 9.994929183335238e-05, 'epoch': 1.13}

 12%|████████▌                                                              | 112/930 [00:57<05:50,  2.33it/s]

 13%|████████▉                                                              | 117/930 [00:59<05:26,  2.49it/s]
{'loss': 2.2973, 'grad_norm': 3.375042200088501, 'learning_rate': 9.984476038137436e-05, 'epoch': 1.23}

 13%|█████████▎                                                             | 122/930 [01:01<05:22,  2.51it/s]
{'loss': 2.2058, 'grad_norm': 3.3097903728485107, 'learning_rate': 9.974346616959476e-05, 'epoch': 1.29}

 14%|█████████▌                                                             | 126/930 [01:03<06:25,  2.08it/s]

 14%|█████████▉                                                             | 130/930 [01:05<06:31,  2.04it/s]

 15%|██████████▎                                                            | 135/930 [01:07<05:47,  2.29it/s]
{'loss': 2.0023, 'grad_norm': 3.1589486598968506, 'learning_rate': 9.94652603162896e-05, 'epoch': 1.42}

 15%|██████████▌                                                            | 139/930 [01:09<05:26,  2.42it/s]
{'loss': 1.8785, 'grad_norm': 3.489053249359131, 'learning_rate': 9.928848976574019e-05, 'epoch': 1.48}

 15%|██████████▉                                                            | 144/930 [01:11<05:24,  2.42it/s]

 16%|███████████▍                                                           | 149/930 [01:13<05:15,  2.48it/s]
{'loss': 1.7711, 'grad_norm': 3.133222818374634, 'learning_rate': 9.897649706262473e-05, 'epoch': 1.58}

 17%|███████████▊                                                           | 154/930 [01:15<05:07,  2.53it/s]

 17%|████████████                                                           | 158/930 [01:17<06:24,  2.01it/s]
{'loss': 1.6614, 'grad_norm': 3.1530396938323975, 'learning_rate': 9.860862128789953e-05, 'epoch': 1.68}

 17%|████████████▎                                                          | 162/930 [01:19<06:24,  2.00it/s]

 18%|████████████▋                                                          | 166/930 [01:21<05:34,  2.29it/s]
{'loss': 1.5248, 'grad_norm': 3.344566583633423, 'learning_rate': 9.818528219449705e-05, 'epoch': 1.77}

 18%|█████████████▏                                                         | 172/930 [01:23<05:02,  2.51it/s]

 19%|█████████████▎                                                         | 175/930 [01:25<06:21,  1.98it/s]
{'loss': 1.3703, 'grad_norm': 2.8878815174102783, 'learning_rate': 9.770696282000244e-05, 'epoch': 1.87}

 19%|█████████████▊                                                         | 181/930 [01:27<05:01,  2.49it/s]
 20%|██████████████▏                                                        | 186/930 [01:29<04:54,  2.53it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32
{'loss': 1.2843, 'grad_norm': 2.588967800140381, 'learning_rate': 9.717420893549902e-05, 'epoch': 1.97}
{'loss': 1.2126, 'grad_norm': 3.4255659580230713, 'learning_rate': 9.698463103929542e-05, 'epoch': 2.0}

 92%|██████████████████████████████████████████████████████████████████▉      | 22/24 [00:03<00:00,  5.59it/s]
Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-186/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-186/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-186/preprocessor_config.json
 20%|██████████████▌                                                        | 190/930 [01:37<12:43,  1.03s/it]

 21%|██████████████▋                                                        | 193/930 [01:39<09:06,  1.35it/s]

 21%|███████████████                                                        | 198/930 [01:41<06:26,  1.89it/s]
{'loss': 1.098, 'grad_norm': 2.44697642326355, 'learning_rate': 9.63802540387394e-05, 'epoch': 2.1}

 22%|███████████████▍                                                       | 202/930 [01:43<06:13,  1.95it/s]

 22%|███████████████▊                                                       | 207/930 [01:45<04:56,  2.44it/s]
{'loss': 1.126, 'grad_norm': 2.3944320678710938, 'learning_rate': 9.57229563269612e-05, 'epoch': 2.19}

 23%|████████████████▏                                                      | 212/930 [01:47<04:48,  2.49it/s]
{'loss': 1.0465, 'grad_norm': 2.087818145751953, 'learning_rate': 9.525572536251607e-05, 'epoch': 2.26}

 23%|████████████████▍                                                      | 215/930 [01:49<05:41,  2.09it/s]

 24%|████████████████▋                                                      | 219/930 [01:51<06:12,  1.91it/s]

 24%|█████████████████                                                      | 223/930 [01:53<05:53,  2.00it/s]

 24%|█████████████████▎                                                     | 227/930 [01:55<05:44,  2.04it/s]
{'loss': 0.8971, 'grad_norm': 2.077761173248291, 'learning_rate': 9.398778314631801e-05, 'epoch': 2.42}

 25%|█████████████████▋                                                     | 231/930 [01:57<06:25,  1.81it/s]

 25%|█████████████████▉                                                     | 235/930 [01:59<05:56,  1.95it/s]

 26%|██████████████████▏                                                    | 239/930 [02:01<06:04,  1.90it/s]
{'loss': 0.8509, 'grad_norm': 2.106156349182129, 'learning_rate': 9.287285680653254e-05, 'epoch': 2.55}

 26%|██████████████████▌                                                    | 243/930 [02:03<05:59,  1.91it/s]

 27%|██████████████████▊                                                    | 247/930 [02:05<05:41,  2.00it/s]

 27%|███████████████████▏                                                   | 251/930 [02:07<05:02,  2.24it/s]
{'loss': 0.7966, 'grad_norm': 1.741970419883728, 'learning_rate': 9.167097030804288e-05, 'epoch': 2.68}

 28%|███████████████████▌                                                   | 256/930 [02:09<04:36,  2.43it/s]
{'loss': 0.7046, 'grad_norm': 1.6244306564331055, 'learning_rate': 9.103817206036382e-05, 'epoch': 2.74}

 28%|███████████████████▉                                                   | 261/930 [02:11<04:36,  2.42it/s]

 29%|████████████████████▎                                                  | 266/930 [02:13<04:21,  2.54it/s]
{'loss': 0.7342, 'grad_norm': 1.6635249853134155, 'learning_rate': 9.005005472346924e-05, 'epoch': 2.84}

 29%|████████████████████▋                                                  | 271/930 [02:15<04:34,  2.40it/s]

 30%|█████████████████████                                                  | 276/930 [02:17<04:27,  2.44it/s]
{'loss': 0.6647, 'grad_norm': 1.5751769542694092, 'learning_rate': 8.90162395476046e-05, 'epoch': 2.94}
 30%|█████████████████████▎                                                 | 279/930 [02:18<03:54,  2.78it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32
 29%|█████████████████████▌                                                    | 7/24 [00:01<00:02,  6.01it/s]

Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-279/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-279/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-279/preprocessor_config.json
Deleting older checkpoint [checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-93] due to args.save_total_limit
 30%|█████████████████████▍                                                 | 280/930 [02:23<15:42,  1.45s/it]

 31%|█████████████████████▋                                                 | 284/930 [02:25<07:57,  1.35it/s]
{'loss': 0.5925, 'grad_norm': 1.6084630489349365, 'learning_rate': 8.793790613463955e-05, 'epoch': 3.03}

 31%|█████████████████████▉                                                 | 288/930 [02:27<06:09,  1.74it/s]

 31%|██████████████████████▎                                                | 292/930 [02:29<05:23,  1.97it/s]

 32%|██████████████████████▋                                                | 297/930 [02:31<04:44,  2.22it/s]
{'loss': 0.6003, 'grad_norm': 1.53374183177948, 'learning_rate': 8.643301141529619e-05, 'epoch': 3.16}

 32%|███████████████████████                                                | 302/930 [02:33<04:12,  2.49it/s]
{'loss': 0.5935, 'grad_norm': 1.6255806684494019, 'learning_rate': 8.565265558156101e-05, 'epoch': 3.23}

 33%|███████████████████████▎                                               | 306/930 [02:35<04:47,  2.17it/s]

 33%|███████████████████████▋                                               | 310/930 [02:37<05:27,  1.89it/s]

 34%|███████████████████████▉                                               | 314/930 [02:39<05:09,  1.99it/s]
{'loss': 0.4995, 'grad_norm': 1.544055700302124, 'learning_rate': 8.403810553682307e-05, 'epoch': 3.35}

 34%|████████████████████████▎                                              | 319/930 [02:41<04:16,  2.38it/s]

 35%|████████████████████████▋                                              | 324/930 [02:43<04:10,  2.42it/s]
{'loss': 0.5632, 'grad_norm': 1.7634265422821045, 'learning_rate': 8.278170082095423e-05, 'epoch': 3.45}

 35%|█████████████████████████                                              | 329/930 [02:46<04:10,  2.40it/s]
{'loss': 0.5643, 'grad_norm': 1.6276437044143677, 'learning_rate': 8.192322712349917e-05, 'epoch': 3.52}

 36%|█████████████████████████▍                                             | 334/930 [02:48<03:58,  2.50it/s]

 36%|█████████████████████████▋                                             | 337/930 [02:49<05:22,  1.84it/s]

 37%|██████████████████████████                                             | 342/930 [02:51<04:03,  2.41it/s]
{'loss': 0.5644, 'grad_norm': 1.5606056451797485, 'learning_rate': 8.015815410307398e-05, 'epoch': 3.65}

 37%|██████████████████████████▍                                            | 347/930 [02:53<03:52,  2.51it/s]
{'loss': 0.5261, 'grad_norm': 1.507857084274292, 'learning_rate': 7.925244992976538e-05, 'epoch': 3.71}

 38%|██████████████████████████▊                                            | 352/930 [02:55<03:49,  2.52it/s]

 38%|███████████████████████████▏                                           | 356/930 [02:57<04:11,  2.28it/s]
{'loss': 0.4739, 'grad_norm': 1.4053500890731812, 'learning_rate': 7.786622315612183e-05, 'epoch': 3.81}

 39%|███████████████████████████▍                                           | 360/930 [02:59<04:29,  2.12it/s]

 39%|███████████████████████████▊                                           | 365/930 [03:01<03:57,  2.37it/s]
{'loss': 0.5258, 'grad_norm': 1.5259218215942383, 'learning_rate': 7.644820051634812e-05, 'epoch': 3.9}

 40%|████████████████████████████▏                                          | 370/930 [03:03<03:43,  2.50it/s]
{'loss': 0.5098, 'grad_norm': 1.6022989749908447, 'learning_rate': 7.548598528940353e-05, 'epoch': 3.97}
 40%|████████████████████████████▍                                          | 372/930 [03:04<03:16,  2.85it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32

Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-372/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-372/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-372/preprocessor_config.json
Deleting older checkpoint [checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-186] due to args.save_total_limit
{'eval_loss': 0.4743548333644867, 'eval_accuracy': 0.9201623815967523, 'eval_runtime': 5.0838, 'eval_samples_per_second': 145.365, 'eval_steps_per_second': 4.721, 'epoch': 4.0}
 40%|████████████████████████████▋                                          | 376/930 [03:11<08:25,  1.10it/s]
{'loss': 0.4774, 'grad_norm': 1.391120433807373, 'learning_rate': 7.451084494783668e-05, 'epoch': 4.03}

 41%|█████████████████████████████                                          | 381/930 [03:13<04:33,  2.01it/s]

 42%|█████████████████████████████▍                                         | 386/930 [03:15<03:45,  2.41it/s]
{'loss': 0.5253, 'grad_norm': 1.5848639011383057, 'learning_rate': 7.302498337922293e-05, 'epoch': 4.13}

 42%|█████████████████████████████▊                                         | 390/930 [03:17<04:29,  2.00it/s]

 42%|██████████████████████████████                                         | 393/930 [03:19<04:42,  1.90it/s]

 43%|██████████████████████████████▍                                        | 398/930 [03:21<04:04,  2.18it/s]
{'loss': 0.3877, 'grad_norm': 1.3308404684066772, 'learning_rate': 7.100326457067575e-05, 'epoch': 4.26}

 43%|██████████████████████████████▊                                        | 403/930 [03:23<03:35,  2.44it/s]
{'loss': 0.4143, 'grad_norm': 1.2969181537628174, 'learning_rate': 6.997616984257552e-05, 'epoch': 4.32}

 44%|███████████████████████████████▏                                       | 408/930 [03:25<03:51,  2.25it/s]

 44%|███████████████████████████████▌                                       | 413/930 [03:27<03:28,  2.48it/s]
{'loss': 0.441, 'grad_norm': 1.435718059539795, 'learning_rate': 6.841669662609436e-05, 'epoch': 4.42}

 45%|███████████████████████████████▉                                       | 418/930 [03:29<03:19,  2.57it/s]
{'loss': 0.4453, 'grad_norm': 1.1929895877838135, 'learning_rate': 6.736526264224101e-05, 'epoch': 4.48}

 45%|████████████████████████████████▎                                      | 423/930 [03:31<03:17,  2.57it/s]

 46%|████████████████████████████████▋                                      | 428/930 [03:33<03:13,  2.59it/s]
{'loss': 0.4113, 'grad_norm': 1.3689059019088745, 'learning_rate': 6.577176692426279e-05, 'epoch': 4.58}

 46%|████████████████████████████████▉                                      | 431/930 [03:35<04:10,  2.00it/s]


 47%|█████████████████████████████████▏                                     | 435/930 [03:39<06:49,  1.21it/s]

 47%|█████████████████████████████████▌                                     | 439/930 [03:41<04:36,  1.78it/s]
{'loss': 0.4008, 'grad_norm': 1.0258229970932007, 'learning_rate': 6.361942964380967e-05, 'epoch': 4.71}

 48%|█████████████████████████████████▊                                     | 443/930 [03:43<04:18,  1.89it/s]

 48%|██████████████████████████████████▏                                    | 448/930 [03:45<03:32,  2.27it/s]

 49%|██████████████████████████████████▌                                    | 453/930 [03:47<03:07,  2.54it/s]
{'loss': 0.3478, 'grad_norm': 1.073464274406433, 'learning_rate': 6.14394677110356e-05, 'epoch': 4.84}

 49%|██████████████████████████████████▉                                    | 458/930 [03:49<03:13,  2.44it/s]
{'loss': 0.3426, 'grad_norm': 1.25851571559906, 'learning_rate': 6.034050732923537e-05, 'epoch': 4.9}

 50%|███████████████████████████████████▎                                   | 463/930 [03:51<03:10,  2.45it/s]
{'loss': 0.4414, 'grad_norm': 1.2535804510116577, 'learning_rate': 5.923630280085948e-05, 'epoch': 4.97}
 50%|███████████████████████████████████▌                                   | 465/930 [03:52<02:48,  2.76it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32

Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-465/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-465/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-465/preprocessor_config.json
Deleting older checkpoint [checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-279] due to args.save_total_limit
 50%|███████████████████████████████████▌                                   | 466/930 [03:57<11:42,  1.51s/it]

 51%|███████████████████████████████████▉                                   | 471/930 [03:59<04:51,  1.58it/s]
{'loss': 0.3225, 'grad_norm': 0.8746192455291748, 'learning_rate': 5.812741411877982e-05, 'epoch': 5.03}

 51%|████████████████████████████████████▎                                  | 476/930 [04:02<03:43,  2.03it/s]
{'loss': 0.3878, 'grad_norm': 1.491236925125122, 'learning_rate': 5.701440365141799e-05, 'epoch': 5.1}

 52%|████████████████████████████████████▌                                  | 479/930 [04:03<03:48,  1.97it/s]

 52%|████████████████████████████████████▉                                  | 484/930 [04:06<03:42,  2.01it/s]

 52%|█████████████████████████████████████▎                                 | 488/930 [04:07<03:15,  2.26it/s]
{'loss': 0.3787, 'grad_norm': 1.1784398555755615, 'learning_rate': 5.477827700000492e-05, 'epoch': 5.23}

 53%|█████████████████████████████████████▋                                 | 494/930 [04:10<02:53,  2.52it/s]
{'loss': 0.318, 'grad_norm': 1.150185227394104, 'learning_rate': 5.3656294858563803e-05, 'epoch': 5.29}

 54%|██████████████████████████████████████                                 | 498/930 [04:11<02:55,  2.47it/s]

 54%|██████████████████████████████████████▍                                | 503/930 [04:13<02:47,  2.55it/s]
{'loss': 0.3953, 'grad_norm': 1.3795666694641113, 'learning_rate': 5.197002296068878e-05, 'epoch': 5.39}

 55%|██████████████████████████████████████▊                                | 508/930 [04:15<03:06,  2.27it/s]

 55%|███████████████████████████████████████▏                               | 513/930 [04:17<02:45,  2.52it/s]
{'loss': 0.3356, 'grad_norm': 0.9927736520767212, 'learning_rate': 5.02815032308783e-05, 'epoch': 5.48}

 56%|███████████████████████████████████████▌                               | 518/930 [04:20<03:02,  2.26it/s]
{'loss': 0.2953, 'grad_norm': 1.005710244178772, 'learning_rate': 4.915552599930345e-05, 'epoch': 5.55}

 56%|███████████████████████████████████████▉                               | 523/930 [04:22<02:47,  2.43it/s]

 57%|████████████████████████████████████████▏                              | 527/930 [04:23<03:08,  2.14it/s]
{'loss': 0.3836, 'grad_norm': 1.167255163192749, 'learning_rate': 4.746754155806437e-05, 'epoch': 5.65}

 57%|████████████████████████████████████████▌                              | 531/930 [04:25<03:12,  2.07it/s]

 58%|████████████████████████████████████████▉                              | 536/930 [04:28<02:56,  2.23it/s]
{'loss': 0.3043, 'grad_norm': 1.1620606184005737, 'learning_rate': 4.578244669784777e-05, 'epoch': 5.74}

 58%|█████████████████████████████████████████▏                             | 540/930 [04:29<02:48,  2.31it/s]

 59%|█████████████████████████████████████████▌                             | 545/930 [04:31<02:36,  2.47it/s]
{'loss': 0.3643, 'grad_norm': 1.260866641998291, 'learning_rate': 4.410216414245771e-05, 'epoch': 5.84}

 59%|█████████████████████████████████████████▉                             | 550/930 [04:33<02:30,  2.52it/s]
{'loss': 0.3593, 'grad_norm': 1.0152779817581177, 'learning_rate': 4.2985596348582016e-05, 'epoch': 5.9}

 60%|██████████████████████████████████████████▎                            | 555/930 [04:35<02:33,  2.44it/s]
{'loss': 0.3103, 'grad_norm': 1.0695927143096924, 'learning_rate': 4.187258588122019e-05, 'epoch': 5.97}
 60%|██████████████████████████████████████████▌                            | 558/930 [04:36<02:14,  2.77it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32

Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-558/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-558/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-558/preprocessor_config.json
Deleting older checkpoint [checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-372] due to args.save_total_limit
 60%|██████████████████████████████████████████▋                            | 559/930 [04:42<08:57,  1.45s/it]

 61%|███████████████████████████████████████████                            | 564/930 [04:44<03:46,  1.62it/s]
{'loss': 0.3409, 'grad_norm': 1.5043960809707642, 'learning_rate': 4.076369719914055e-05, 'epoch': 6.03}

 61%|███████████████████████████████████████████▍                           | 569/930 [04:46<02:43,  2.21it/s]

 62%|███████████████████████████████████████████▊                           | 574/930 [04:48<02:26,  2.44it/s]
{'loss': 0.3458, 'grad_norm': 1.1092065572738647, 'learning_rate': 3.9109322062557424e-05, 'epoch': 6.13}

 62%|████████████████████████████████████████████▏                          | 578/930 [04:49<02:38,  2.21it/s]

 63%|████████████████████████████████████████████▍                          | 582/930 [04:52<02:59,  1.94it/s]
{'loss': 0.3792, 'grad_norm': 1.4845614433288574, 'learning_rate': 3.746737338706397e-05, 'epoch': 6.23}

 63%|████████████████████████████████████████████▋                          | 586/930 [04:54<02:50,  2.02it/s]

 64%|█████████████████████████████████████████████                          | 591/930 [04:56<02:22,  2.38it/s]
{'loss': 0.3391, 'grad_norm': 1.3080350160598755, 'learning_rate': 3.58397246658848e-05, 'epoch': 6.32}

 64%|█████████████████████████████████████████████▌                         | 596/930 [04:58<02:16,  2.45it/s]

 64%|█████████████████████████████████████████████▋                         | 599/930 [04:59<02:51,  1.93it/s]

 65%|██████████████████████████████████████████████                         | 603/930 [05:02<02:57,  1.84it/s]
{'loss': 0.3006, 'grad_norm': 1.1438251733779907, 'learning_rate': 3.3694978064505254e-05, 'epoch': 6.45}

 65%|██████████████████████████████████████████████▍                        | 608/930 [05:04<02:24,  2.23it/s]

 66%|██████████████████████████████████████████████▊                        | 613/930 [05:06<02:06,  2.50it/s]
{'loss': 0.2853, 'grad_norm': 1.2197864055633545, 'learning_rate': 3.210788609070504e-05, 'epoch': 6.55}

 66%|███████████████████████████████████████████████▏                       | 618/930 [05:08<02:01,  2.56it/s]
{'loss': 0.2706, 'grad_norm': 0.9835421442985535, 'learning_rate': 3.10610557194712e-05, 'epoch': 6.61}

 67%|███████████████████████████████████████████████▍                       | 621/930 [05:10<02:38,  1.95it/s]

 67%|███████████████████████████████████████████████▋                       | 625/930 [05:12<02:42,  1.88it/s]

 68%|████████████████████████████████████████████████                       | 629/930 [05:14<02:40,  1.87it/s]

 68%|████████████████████████████████████████████████▎                      | 633/930 [05:16<02:30,  1.97it/s]

 68%|████████████████████████████████████████████████▋                      | 637/930 [05:18<02:39,  1.83it/s]
{'loss': 0.2824, 'grad_norm': 1.0065734386444092, 'learning_rate': 2.798029242211828e-05, 'epoch': 6.81}

 69%|████████████████████████████████████████████████▉                      | 641/930 [05:20<02:26,  1.97it/s]

 69%|█████████████████████████████████████████████████▏                     | 645/930 [05:22<02:26,  1.94it/s]

 70%|█████████████████████████████████████████████████▌                     | 649/930 [05:24<02:20,  2.01it/s]
{'loss': 0.327, 'grad_norm': 1.2955422401428223, 'learning_rate': 2.598141784686775e-05, 'epoch': 6.94}
 70%|█████████████████████████████████████████████████▋                     | 651/930 [05:24<01:59,  2.33it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32
 21%|███████████████▍                                                          | 5/24 [00:00<00:03,  5.06it/s]

Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-651/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-651/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-651/preprocessor_config.json
Deleting older checkpoint [checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-465] due to args.save_total_limit
{'eval_loss': 0.3394675552845001, 'eval_accuracy': 0.9296346414073072, 'eval_runtime': 4.6505, 'eval_samples_per_second': 158.908, 'eval_steps_per_second': 5.161, 'epoch': 7.0}
 70%|██████████████████████████████████████████████████                     | 655/930 [05:31<04:05,  1.12it/s]

 71%|██████████████████████████████████████████████████▍                    | 660/930 [05:33<02:17,  1.97it/s]
{'loss': 0.3477, 'grad_norm': 1.082446813583374, 'learning_rate': 2.4031260802275623e-05, 'epoch': 7.06}

 72%|██████████████████████████████████████████████████▊                    | 665/930 [05:35<01:48,  2.43it/s]
{'loss': 0.3488, 'grad_norm': 1.1649097204208374, 'learning_rate': 2.3075691545870558e-05, 'epoch': 7.13}

 72%|███████████████████████████████████████████████████▏                   | 670/930 [05:37<01:44,  2.49it/s]

 72%|███████████████████████████████████████████████████▎                   | 672/930 [05:38<01:42,  2.51it/s]

 73%|███████████████████████████████████████████████████▌                   | 675/930 [05:41<03:00,  1.42it/s]

 73%|███████████████████████████████████████████████████▉                   | 680/930 [05:44<01:58,  2.12it/s]

 74%|████████████████████████████████████████████████████▎                  | 685/930 [05:46<01:40,  2.43it/s]
{'loss': 0.3166, 'grad_norm': 1.2051035165786743, 'learning_rate': 2.0292814688986372e-05, 'epoch': 7.32}

 74%|████████████████████████████████████████████████████▌                  | 689/930 [05:47<01:37,  2.46it/s]
{'loss': 0.3185, 'grad_norm': 1.0660940408706665, 'learning_rate': 1.9394700872616855e-05, 'epoch': 7.39}

 75%|████████████████████████████████████████████████████▉                  | 694/930 [05:49<01:37,  2.43it/s]

 75%|█████████████████████████████████████████████████████▎                 | 699/930 [05:51<01:35,  2.43it/s]
{'loss': 0.3442, 'grad_norm': 1.263534665107727, 'learning_rate': 1.807677287650083e-05, 'epoch': 7.48}

 76%|█████████████████████████████████████████████████████▋                 | 704/930 [05:53<01:33,  2.41it/s]
{'loss': 0.29, 'grad_norm': 1.0616357326507568, 'learning_rate': 1.721829917904579e-05, 'epoch': 7.55}

 76%|██████████████████████████████████████████████████████▏                | 709/930 [05:55<01:29,  2.47it/s]

 77%|██████████████████████████████████████████████████████▌                | 714/930 [05:58<01:31,  2.35it/s]
{'loss': 0.3109, 'grad_norm': 1.145977258682251, 'learning_rate': 1.5961894463176942e-05, 'epoch': 7.65}

 77%|██████████████████████████████████████████████████████▉                | 719/930 [06:00<01:28,  2.38it/s]

 78%|███████████████████████████████████████████████████████▏               | 723/930 [06:01<01:24,  2.44it/s]
{'loss': 0.291, 'grad_norm': 1.031367540359497, 'learning_rate': 1.4744327843196043e-05, 'epoch': 7.74}

 78%|███████████████████████████████████████████████████████▌               | 728/930 [06:04<01:34,  2.14it/s]

 79%|███████████████████████████████████████████████████████▉               | 732/930 [06:06<01:30,  2.18it/s]
{'loss': 0.323, 'grad_norm': 0.968706488609314, 'learning_rate': 1.3566988584703816e-05, 'epoch': 7.84}

 79%|████████████████████████████████████████████████████████▎              | 737/930 [06:08<01:20,  2.40it/s]

 80%|████████████████████████████████████████████████████████▋              | 742/930 [06:10<01:17,  2.42it/s]
{'loss': 0.3321, 'grad_norm': 1.2262494564056396, 'learning_rate': 1.2431220053151833e-05, 'epoch': 7.94}
{'loss': 0.2938, 'grad_norm': 1.003989577293396, 'learning_rate': 1.2062093865360458e-05, 'epoch': 7.97}
 80%|████████████████████████████████████████████████████████▊              | 744/930 [06:10<01:06,  2.79it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32

Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-744/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-744/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-744/preprocessor_config.json
Deleting older checkpoint [checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-558] due to args.save_total_limit
 80%|████████████████████████████████████████████████████████▉              | 745/930 [06:15<04:32,  1.48s/it]

 81%|█████████████████████████████████████████████████████████▎             | 751/930 [06:18<01:38,  1.81it/s]
{'loss': 0.3178, 'grad_norm': 1.1937987804412842, 'learning_rate': 1.1338318181038038e-05, 'epoch': 8.03}

 81%|█████████████████████████████████████████████████████████▋             | 756/930 [06:20<01:15,  2.30it/s]
{'loss': 0.3541, 'grad_norm': 1.086360216140747, 'learning_rate': 1.063414961267859e-05, 'epoch': 8.1}

 82%|██████████████████████████████████████████████████████████             | 761/930 [06:22<01:07,  2.52it/s]

 82%|██████████████████████████████████████████████████████████▍            | 766/930 [06:24<01:06,  2.46it/s]
{'loss': 0.2778, 'grad_norm': 1.294303297996521, 'learning_rate': 9.615438530716753e-06, 'epoch': 8.19}

 83%|██████████████████████████████████████████████████████████▊            | 770/930 [06:26<01:23,  1.92it/s]

 83%|███████████████████████████████████████████████████████████            | 773/930 [06:27<01:23,  1.88it/s]

 84%|███████████████████████████████████████████████████████████▎           | 777/930 [06:30<01:19,  1.91it/s]
{'loss': 0.2706, 'grad_norm': 1.0789835453033447, 'learning_rate': 8.329029691957124e-06, 'epoch': 8.32}

 84%|███████████████████████████████████████████████████████████▋           | 782/930 [06:32<01:10,  2.09it/s]

 84%|███████████████████████████████████████████████████████████▉           | 785/930 [06:33<01:14,  1.94it/s]

 85%|████████████████████████████████████████████████████████████▏          | 789/930 [06:36<01:14,  1.90it/s]
{'loss': 0.4113, 'grad_norm': 1.8226735591888428, 'learning_rate': 7.127143193467445e-06, 'epoch': 8.45}

 85%|████████████████████████████████████████████████████████████▌          | 793/930 [06:38<01:12,  1.89it/s]

 86%|████████████████████████████████████████████████████████████▊          | 797/930 [06:40<01:05,  2.03it/s]

 86%|█████████████████████████████████████████████████████████████▏         | 802/930 [06:42<00:54,  2.34it/s]
{'loss': 0.2934, 'grad_norm': 0.9534235596656799, 'learning_rate': 6.012216853682001e-06, 'epoch': 8.58}

 87%|█████████████████████████████████████████████████████████████▌         | 806/930 [06:44<00:52,  2.36it/s]
{'loss': 0.2837, 'grad_norm': 1.0704265832901, 'learning_rate': 5.488077459582425e-06, 'epoch': 8.65}

 87%|█████████████████████████████████████████████████████████████▉         | 811/930 [06:46<00:48,  2.44it/s]

 88%|██████████████████████████████████████████████████████████████▎        | 816/930 [06:48<00:48,  2.36it/s]
{'loss': 0.2694, 'grad_norm': 1.1862339973449707, 'learning_rate': 4.744274637483936e-06, 'epoch': 8.74}

 88%|██████████████████████████████████████████████████████████████▋        | 821/930 [06:50<00:44,  2.46it/s]

 89%|███████████████████████████████████████████████████████████████        | 826/930 [06:52<00:41,  2.50it/s]
{'loss': 0.2667, 'grad_norm': 0.9056856036186218, 'learning_rate': 4.05210941898847e-06, 'epoch': 8.84}

 89%|███████████████████████████████████████████████████████████████▍       | 831/930 [06:54<00:40,  2.44it/s]
{'loss': 0.3284, 'grad_norm': 1.1847898960113525, 'learning_rate': 3.619745961260623e-06, 'epoch': 8.9}
 90%|███████████████████████████████████████████████████████████████▉       | 837/930 [06:56<00:32,  2.85it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32
  0%|                                                                                  | 0/24 [00:00<?, ?it/s]
{'loss': 0.2645, 'grad_norm': 0.9321953058242798, 'learning_rate': 3.2109040622582186e-06, 'epoch': 8.97}


Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-837/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-837/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-837/preprocessor_config.json
Deleting older checkpoint [checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-651] due to args.save_total_limit
 90%|████████████████████████████████████████████████████████████████▏      | 840/930 [07:02<01:28,  1.01it/s]
{'eval_loss': 0.326984703540802, 'eval_accuracy': 0.93234100135318, 'eval_runtime': 4.2553, 'eval_samples_per_second': 173.665, 'eval_steps_per_second': 5.64, 'epoch': 9.0}

 91%|████████████████████████████████████████████████████████████████▌      | 845/930 [07:04<00:43,  1.97it/s]

 91%|████████████████████████████████████████████████████████████████▉      | 850/930 [07:06<00:36,  2.22it/s]
{'loss': 0.2534, 'grad_norm': 0.9220529794692993, 'learning_rate': 2.464602276492084e-06, 'epoch': 9.1}

 92%|█████████████████████████████████████████████████████████████████▎     | 855/930 [07:08<00:30,  2.47it/s]
{'loss': 0.3179, 'grad_norm': 1.367187738418579, 'learning_rate': 2.127520873668226e-06, 'epoch': 9.16}

 92%|█████████████████████████████████████████████████████████████████▌     | 859/930 [07:10<00:30,  2.34it/s]

 93%|█████████████████████████████████████████████████████████████████▉     | 864/930 [07:12<00:28,  2.32it/s]
{'loss': 0.2737, 'grad_norm': 1.1779974699020386, 'learning_rate': 1.6674707041276938e-06, 'epoch': 9.26}

 93%|██████████████████████████████████████████████████████████████████▎    | 869/930 [07:14<00:23,  2.54it/s]

 94%|██████████████████████████████████████████████████████████████████▋    | 874/930 [07:16<00:23,  2.41it/s]
{'loss': 0.3003, 'grad_norm': 1.0603541135787964, 'learning_rate': 1.2625688272930926e-06, 'epoch': 9.35}

 95%|███████████████████████████████████████████████████████████████████    | 879/930 [07:18<00:21,  2.40it/s]
{'loss': 0.3254, 'grad_norm': 1.0283236503601074, 'learning_rate': 1.0235029373752758e-06, 'epoch': 9.42}

 95%|███████████████████████████████████████████████████████████████████▍   | 884/930 [07:20<00:18,  2.52it/s]

 95%|███████████████████████████████████████████████████████████████████▊   | 888/930 [07:22<00:17,  2.38it/s]
{'loss': 0.3093, 'grad_norm': 1.0781002044677734, 'learning_rate': 7.115102342598101e-07, 'epoch': 9.52}

 96%|████████████████████████████████████████████████████████████████████▏  | 893/930 [07:24<00:15,  2.32it/s]

 97%|████████████████████████████████████████████████████████████████████▌  | 898/930 [07:26<00:12,  2.51it/s]
{'loss': 0.2997, 'grad_norm': 1.2801018953323364, 'learning_rate': 4.55756592088058e-07, 'epoch': 9.61}

 97%|████████████████████████████████████████████████████████████████████▉  | 903/930 [07:28<00:10,  2.46it/s]
{'loss': 0.3069, 'grad_norm': 1.2834807634353638, 'learning_rate': 3.1664484641086287e-07, 'epoch': 9.68}

 98%|█████████████████████████████████████████████████████████████████████▏ | 907/930 [07:29<00:09,  2.54it/s]

 98%|█████████████████████████████████████████████████████████████████████▋ | 913/930 [07:32<00:06,  2.49it/s]
{'loss': 0.3071, 'grad_norm': 1.033962607383728, 'learning_rate': 1.5523961862564106e-07, 'epoch': 9.77}

 99%|██████████████████████████████████████████████████████████████████████ | 918/930 [07:34<00:05,  2.26it/s]
{'loss': 0.3237, 'grad_norm': 1.122362494468689, 'learning_rate': 7.92239759864255e-08, 'epoch': 9.84}

 99%|██████████████████████████████████████████████████████████████████████▍| 922/930 [07:36<00:03,  2.15it/s]

100%|██████████████████████████████████████████████████████████████████████▊| 927/930 [07:38<00:01,  2.36it/s]
{'loss': 0.3422, 'grad_norm': 1.0823200941085815, 'learning_rate': 1.2678649143349486e-08, 'epoch': 9.94}
100%|███████████████████████████████████████████████████████████████████████| 930/930 [07:39<00:00,  2.68it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32
 29%|█████████████████████▌                                                    | 7/24 [00:01<00:02,  6.06it/s]

Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-930/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-930/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-930/preprocessor_config.json
Deleting older checkpoint [checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-744] due to args.save_total_limit
Training completed. Do not forget to share your model on huggingface.co/models =)
Loading best model from ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/checkpoint-837 (score: 0.93234100135318).
100%|███████████████████████████████████████████████████████████████████████| 930/930 [07:44<00:00,  2.00it/s]
***** Running Evaluation *****
  Num examples = 739
  Batch size = 32
  0%|                                                                                  | 0/24 [00:00<?, ?it/s]
{'eval_loss': 0.32650306820869446, 'eval_accuracy': 0.93234100135318, 'eval_runtime': 4.174, 'eval_samples_per_second': 177.047, 'eval_steps_per_second': 5.75, 'epoch': 10.0}


100%|█████████████████████████████████████████████████████████████████████████| 24/24 [00:04<00:00,  4.98it/s]
Saving model checkpoint to ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35
Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:21-35/preprocessor_config.json
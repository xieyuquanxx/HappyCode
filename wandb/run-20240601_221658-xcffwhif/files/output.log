
  0%|▏                                                                        | 2/930 [00:01<13:07,  1.18it/s]

  1%|▍                                                                        | 6/930 [00:03<08:36,  1.79it/s]
{'loss': 3.7254, 'grad_norm': 4.040950298309326, 'learning_rate': 5.161290322580646e-06, 'epoch': 0.06}

  1%|▊                                                                       | 10/930 [00:05<07:04,  2.17it/s]

  2%|█                                                                       | 14/930 [00:07<07:35,  2.01it/s]
{'loss': 3.5982, 'grad_norm': 4.320849895477295, 'learning_rate': 1.2903225806451613e-05, 'epoch': 0.16}

  2%|█▍                                                                      | 18/930 [00:09<07:43,  1.97it/s]

  2%|█▊                                                                      | 23/930 [00:11<06:48,  2.22it/s]
{'loss': 3.5925, 'grad_norm': 3.9180002212524414, 'learning_rate': 2.0645161290322582e-05, 'epoch': 0.26}

  3%|██▏                                                                     | 28/930 [00:14<06:21,  2.36it/s]

  3%|██▍                                                                     | 32/930 [00:15<06:18,  2.37it/s]
{'loss': 3.5251, 'grad_norm': 4.017615795135498, 'learning_rate': 2.8387096774193552e-05, 'epoch': 0.35}

  4%|██▊                                                                     | 37/930 [00:17<06:16,  2.37it/s]
{'loss': 3.3639, 'grad_norm': 4.245150089263916, 'learning_rate': 3.3548387096774195e-05, 'epoch': 0.42}

  5%|███▎                                                                    | 42/930 [00:19<06:16,  2.36it/s]

  5%|███▋                                                                    | 47/930 [00:22<06:18,  2.33it/s]
{'loss': 3.2134, 'grad_norm': 3.725797653198242, 'learning_rate': 4.1290322580645165e-05, 'epoch': 0.52}

  5%|███▉                                                                    | 51/930 [00:23<06:09,  2.38it/s]

  6%|████▎                                                                   | 55/930 [00:25<06:55,  2.11it/s]

  6%|████▌                                                                   | 59/930 [00:27<07:57,  1.82it/s]
{'loss': 3.0051, 'grad_norm': 4.008785247802734, 'learning_rate': 5.161290322580645e-05, 'epoch': 0.65}

  7%|████▊                                                                   | 62/930 [00:29<08:56,  1.62it/s]

  7%|█████▏                                                                  | 67/930 [00:31<06:28,  2.22it/s]
{'loss': 2.7599, 'grad_norm': 3.7554705142974854, 'learning_rate': 5.935483870967743e-05, 'epoch': 0.74}

  8%|█████▌                                                                  | 72/930 [00:34<06:12,  2.30it/s]

  8%|█████▉                                                                  | 76/930 [00:35<06:01,  2.37it/s]
{'loss': 2.508, 'grad_norm': 3.781219005584717, 'learning_rate': 6.709677419354839e-05, 'epoch': 0.84}

  9%|██████▎                                                                 | 81/930 [00:37<06:14,  2.27it/s]

  9%|██████▋                                                                 | 86/930 [00:40<06:03,  2.32it/s]
{'loss': 2.2398, 'grad_norm': 3.57334566116333, 'learning_rate': 7.483870967741936e-05, 'epoch': 0.94}

 10%|██████▉                                                                 | 90/930 [00:41<05:51,  2.39it/s]
 10%|███████▏                                                                | 93/930 [00:42<05:08,  2.72it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32


100%|█████████████████████████████████████████████████████████████████████████| 24/24 [00:03<00:00,  8.39it/s]
Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-93/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-93/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-93/preprocessor_config.json
{'loss': 1.8457, 'grad_norm': 3.3264307975769043, 'learning_rate': 7.999746418979217e-05, 'epoch': 1.03}
 10%|███████▍                                                                | 96/930 [00:52<20:06,  1.45s/it]

 11%|███████▋                                                               | 100/930 [00:53<09:28,  1.46it/s]

 11%|████████                                                               | 105/930 [00:58<08:34,  1.60it/s]
{'loss': 1.6024, 'grad_norm': 3.476010799407959, 'learning_rate': 7.99594334666819e-05, 'epoch': 1.13}

 12%|████████▎                                                              | 109/930 [00:59<06:13,  2.20it/s]
{'loss': 1.456, 'grad_norm': 3.343818426132202, 'learning_rate': 7.990874458720283e-05, 'epoch': 1.19}

 12%|████████▋                                                              | 114/930 [01:02<06:36,  2.06it/s]

 13%|█████████                                                              | 118/930 [01:04<06:03,  2.23it/s]
{'loss': 1.2173, 'grad_norm': 2.8394618034362793, 'learning_rate': 7.97947729356758e-05, 'epoch': 1.29}

 13%|█████████▎                                                             | 122/930 [01:05<06:20,  2.12it/s]

 14%|█████████▋                                                             | 127/930 [01:08<06:30,  2.06it/s]

 14%|█████████▉                                                             | 130/930 [01:09<06:48,  1.96it/s]
{'loss': 0.9326, 'grad_norm': 2.235536575317383, 'learning_rate': 7.957220825303168e-05, 'epoch': 1.42}

 15%|██████████▎                                                            | 135/930 [01:12<06:32,  2.02it/s]

 15%|██████████▌                                                            | 139/930 [01:14<05:41,  2.32it/s]
{'loss': 0.7606, 'grad_norm': 2.3761749267578125, 'learning_rate': 7.935257977571317e-05, 'epoch': 1.52}

 16%|███████████                                                            | 145/930 [01:16<05:16,  2.48it/s]
{'loss': 0.7221, 'grad_norm': 1.9808846712112427, 'learning_rate': 7.918119765009979e-05, 'epoch': 1.58}

 16%|███████████▍                                                           | 149/930 [01:18<05:20,  2.44it/s]

 16%|███████████▋                                                           | 153/930 [01:19<06:05,  2.12it/s]

 17%|███████████▉                                                           | 157/930 [01:21<06:18,  2.04it/s]
{'loss': 0.5889, 'grad_norm': 1.5755348205566406, 'learning_rate': 7.87789186329517e-05, 'epoch': 1.71}

 17%|████████████▎                                                          | 162/930 [01:24<05:54,  2.17it/s]

 18%|████████████▋                                                          | 167/930 [01:26<05:11,  2.45it/s]
{'loss': 0.4594, 'grad_norm': 1.4343403577804565, 'learning_rate': 7.842554052527918e-05, 'epoch': 1.81}

 18%|█████████████▏                                                         | 172/930 [01:28<05:14,  2.41it/s]
{'loss': 0.455, 'grad_norm': 1.412199854850769, 'learning_rate': 7.816557025600196e-05, 'epoch': 1.87}

 19%|█████████████▌                                                         | 177/930 [01:30<05:07,  2.45it/s]

 19%|█████████████▊                                                         | 181/930 [01:32<05:14,  2.38it/s]
{'loss': 0.477, 'grad_norm': 1.5939322710037231, 'learning_rate': 7.773936714839922e-05, 'epoch': 1.97}
 20%|██████████████▏                                                        | 186/930 [01:33<04:25,  2.80it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32


 92%|██████████████████████████████████████████████████████████████████▉      | 22/24 [00:03<00:00,  5.61it/s]

Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-186/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-186/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-186/preprocessor_config.json
 20%|██████████████▎                                                        | 188/930 [01:42<20:47,  1.68s/it]
{'loss': 0.4146, 'grad_norm': 1.2761144638061523, 'learning_rate': 7.743127675019344e-05, 'epoch': 2.03}

 21%|██████████████▋                                                        | 192/930 [01:44<09:47,  1.26it/s]

 21%|██████████████▉                                                        | 196/930 [01:46<06:58,  1.75it/s]
{'loss': 0.3666, 'grad_norm': 1.3286572694778442, 'learning_rate': 7.693359926285095e-05, 'epoch': 2.13}

 22%|███████████████▎                                                       | 201/930 [01:48<05:16,  2.31it/s]

 22%|███████████████▋                                                       | 206/930 [01:50<04:58,  2.42it/s]
{'loss': 0.3672, 'grad_norm': 1.2504254579544067, 'learning_rate': 7.639377986875323e-05, 'epoch': 2.23}

 23%|████████████████                                                       | 211/930 [01:52<04:46,  2.51it/s]
{'loss': 0.3119, 'grad_norm': 1.1045446395874023, 'learning_rate': 7.601079031405899e-05, 'epoch': 2.29}

 23%|████████████████▍                                                      | 216/930 [01:54<04:56,  2.41it/s]

 24%|████████████████▊                                                      | 221/930 [01:56<04:39,  2.54it/s]
{'loss': 0.3463, 'grad_norm': 1.1470073461532593, 'learning_rate': 7.540212660154462e-05, 'epoch': 2.39}

 24%|█████████████████▎                                                     | 226/930 [01:58<04:41,  2.50it/s]
{'loss': 0.2595, 'grad_norm': 1.1858054399490356, 'learning_rate': 7.497386464578329e-05, 'epoch': 2.45}

 25%|█████████████████▋                                                     | 231/930 [02:00<04:51,  2.40it/s]

 25%|█████████████████▊                                                     | 234/930 [02:02<05:33,  2.08it/s]

 26%|██████████████████▏                                                    | 239/930 [02:04<05:36,  2.06it/s]
{'loss': 0.2894, 'grad_norm': 1.0559481382369995, 'learning_rate': 7.40643563576742e-05, 'epoch': 2.58}

 26%|██████████████████▌                                                    | 243/930 [02:06<04:49,  2.37it/s]

 27%|██████████████████▊                                                    | 247/930 [02:08<05:44,  1.98it/s]

 27%|███████████████████▏                                                   | 251/930 [02:10<06:01,  1.88it/s]
{'loss': 0.2749, 'grad_norm': 1.2676507234573364, 'learning_rate': 7.308575442720796e-05, 'epoch': 2.71}

 27%|███████████████████▍                                                   | 255/930 [02:12<05:59,  1.88it/s]

 28%|███████████████████▊                                                   | 260/930 [02:14<04:47,  2.33it/s]
{'loss': 0.2523, 'grad_norm': 1.1450293064117432, 'learning_rate': 7.23076491754266e-05, 'epoch': 2.81}

 28%|████████████████████▏                                                  | 265/930 [02:16<04:34,  2.42it/s]

 29%|████████████████████▌                                                  | 269/930 [02:18<04:34,  2.41it/s]
{'loss': 0.1912, 'grad_norm': 0.824557363986969, 'learning_rate': 7.149268030985714e-05, 'epoch': 2.9}

 29%|████████████████████▉                                                  | 274/930 [02:20<04:30,  2.42it/s]

 30%|█████████████████████▏                                                 | 278/930 [02:22<05:03,  2.15it/s]
 30%|█████████████████████▎                                                 | 279/930 [02:22<05:02,  2.15it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32


 92%|██████████████████████████████████████████████████████████████████▉      | 22/24 [00:04<00:00,  5.35it/s]
Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-279/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-279/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-279/preprocessor_config.json
Deleting older checkpoint [checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-93] due to args.save_total_limit
{'loss': 0.1584, 'grad_norm': 1.2597650289535522, 'learning_rate': 7.035032490771165e-05, 'epoch': 3.03}
 30%|█████████████████████▌                                                 | 283/930 [02:32<12:42,  1.18s/it]
{'loss': 0.2427, 'grad_norm': 1.0673425197601318, 'learning_rate': 7.005502395747854e-05, 'epoch': 3.06}

 31%|█████████████████████▉                                                 | 288/930 [02:34<05:45,  1.86it/s]

 31%|██████████████████████▏                                                | 291/930 [02:36<05:38,  1.89it/s]

 32%|██████████████████████▌                                                | 296/930 [02:38<05:10,  2.04it/s]
{'loss': 0.2011, 'grad_norm': 0.8643912672996521, 'learning_rate': 6.883609487033605e-05, 'epoch': 3.19}

 32%|██████████████████████▉                                                | 300/930 [02:40<04:36,  2.28it/s]

 33%|███████████████████████▎                                               | 305/930 [02:42<04:18,  2.42it/s]
{'loss': 0.1939, 'grad_norm': 1.170881986618042, 'learning_rate': 6.788337491790397e-05, 'epoch': 3.29}

 33%|███████████████████████▋                                               | 310/930 [02:44<04:08,  2.50it/s]
{'loss': 0.2203, 'grad_norm': 0.9853377342224121, 'learning_rate': 6.723048442945845e-05, 'epoch': 3.35}

 34%|████████████████████████                                               | 315/930 [02:46<04:23,  2.34it/s]

 34%|████████████████████████▍                                              | 320/930 [02:48<04:12,  2.42it/s]

 35%|████████████████████████▋                                              | 324/930 [02:50<05:02,  2.00it/s]
{'loss': 0.2047, 'grad_norm': 0.8602920174598694, 'learning_rate': 6.588361207597432e-05, 'epoch': 3.48}

 35%|█████████████████████████                                              | 328/930 [02:52<04:26,  2.26it/s]
{'loss': 0.2354, 'grad_norm': 1.0421816110610962, 'learning_rate': 6.51903132718161e-05, 'epoch': 3.55}

 36%|█████████████████████████▍                                             | 333/930 [02:54<04:12,  2.36it/s]


 36%|█████████████████████████▊                                             | 338/930 [02:58<08:12,  1.20it/s]
{'loss': 0.1695, 'grad_norm': 0.8153635859489441, 'learning_rate': 6.41265232824592e-05, 'epoch': 3.65}

 37%|██████████████████████████                                             | 342/930 [03:00<06:18,  1.55it/s]

 37%|██████████████████████████▍                                            | 346/930 [03:02<04:42,  2.07it/s]
{'loss': 0.1511, 'grad_norm': 0.8562581539154053, 'learning_rate': 6.303520449236827e-05, 'epoch': 3.74}

 38%|██████████████████████████▊                                            | 352/930 [03:04<03:55,  2.45it/s]

 38%|███████████████████████████▏                                           | 356/930 [03:06<03:52,  2.47it/s]
{'loss': 0.1196, 'grad_norm': 0.7711961269378662, 'learning_rate': 6.191760211607995e-05, 'epoch': 3.84}

 39%|███████████████████████████▍                                           | 360/930 [03:08<03:53,  2.45it/s]
{'loss': 0.1853, 'grad_norm': 1.0261504650115967, 'learning_rate': 6.11585604130785e-05, 'epoch': 3.9}

 39%|███████████████████████████▊                                           | 365/930 [03:10<03:59,  2.36it/s]
{'loss': 0.1794, 'grad_norm': 1.20428466796875, 'learning_rate': 6.038878823152283e-05, 'epoch': 3.97}

 40%|████████████████████████████▍                                          | 372/930 [03:12<03:16,  2.84it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32


 92%|██████████████████████████████████████████████████████████████████▉      | 22/24 [00:03<00:00,  5.60it/s]
Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-372/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-372/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-372/preprocessor_config.json
Deleting older checkpoint [checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-186] due to args.save_total_limit
{'loss': 0.151, 'grad_norm': 0.9633427858352661, 'learning_rate': 5.960867595826934e-05, 'epoch': 4.03}
 40%|████████████████████████████▋                                          | 375/930 [03:22<13:14,  1.43s/it]
{'loss': 0.15, 'grad_norm': 0.5269387364387512, 'learning_rate': 5.921486572250582e-05, 'epoch': 4.06}

 41%|█████████████████████████████                                          | 380/930 [03:24<05:35,  1.64it/s]

 41%|█████████████████████████████▍                                         | 385/930 [03:26<03:58,  2.29it/s]
{'loss': 0.1588, 'grad_norm': 1.1406517028808594, 'learning_rate': 5.8019018703130924e-05, 'epoch': 4.16}

 42%|█████████████████████████████▊                                         | 390/930 [03:28<03:43,  2.42it/s]
{'loss': 0.1374, 'grad_norm': 0.6139374375343323, 'learning_rate': 5.7210279909509846e-05, 'epoch': 4.23}

 42%|██████████████████████████████                                         | 394/930 [03:30<03:41,  2.42it/s]

 43%|██████████████████████████████▍                                        | 399/930 [03:32<03:57,  2.23it/s]

 43%|██████████████████████████████▊                                        | 403/930 [03:34<04:11,  2.10it/s]
{'loss': 0.146, 'grad_norm': 0.5972604155540466, 'learning_rate': 5.5567032525241315e-05, 'epoch': 4.35}

 44%|███████████████████████████████▏                                       | 408/930 [03:36<04:05,  2.13it/s]

 44%|███████████████████████████████▌                                       | 413/930 [03:38<03:39,  2.35it/s]
{'loss': 0.1186, 'grad_norm': 0.737949788570404, 'learning_rate': 5.4313691127435975e-05, 'epoch': 4.45}

 45%|███████████████████████████████▊                                       | 417/930 [03:40<03:33,  2.40it/s]

 45%|████████████████████████████████▏                                      | 422/930 [03:42<03:59,  2.12it/s]
{'loss': 0.1124, 'grad_norm': 0.5629625916481018, 'learning_rate': 5.3044017548395804e-05, 'epoch': 4.55}

 46%|████████████████████████████████▌                                      | 426/930 [03:44<04:03,  2.07it/s]

 46%|████████████████████████████████▊                                      | 430/930 [03:46<03:32,  2.35it/s]
{'loss': 0.145, 'grad_norm': 0.7837010622024536, 'learning_rate': 5.1759460508707085e-05, 'epoch': 4.65}

 47%|█████████████████████████████████▏                                     | 434/930 [03:48<03:52,  2.14it/s]

 47%|█████████████████████████████████▌                                     | 439/930 [03:50<03:26,  2.38it/s]

 48%|█████████████████████████████████▊                                     | 443/930 [03:52<04:14,  1.91it/s]
{'loss': 0.1528, 'grad_norm': 0.6297533512115479, 'learning_rate': 5.002610129034883e-05, 'epoch': 4.77}

 48%|██████████████████████████████████▏                                    | 447/930 [03:54<04:07,  1.95it/s]

 48%|██████████████████████████████████▍                                    | 451/930 [03:56<03:27,  2.31it/s]
{'loss': 0.1752, 'grad_norm': 1.1539433002471924, 'learning_rate': 4.871254234995406e-05, 'epoch': 4.87}

 49%|██████████████████████████████████▊                                    | 456/930 [03:58<03:18,  2.39it/s]

 49%|███████████████████████████████████                                    | 460/930 [04:00<03:44,  2.10it/s]
{'loss': 0.1391, 'grad_norm': 0.8822764754295349, 'learning_rate': 4.738904224068758e-05, 'epoch': 4.97}
 50%|███████████████████████████████████▌                                   | 465/930 [04:01<02:59,  2.60it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32


 96%|█████████████████████████████████████████████████████████████████████▉   | 23/24 [00:03<00:00,  6.23it/s]

Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-465/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-465/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-465/preprocessor_config.json
Deleting older checkpoint [checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-279] due to args.save_total_limit
 50%|███████████████████████████████████▋                                   | 467/930 [04:10<13:13,  1.71s/it]
{'loss': 0.1513, 'grad_norm': 0.7517200708389282, 'learning_rate': 4.650193129502386e-05, 'epoch': 5.03}

 51%|███████████████████████████████████▉                                   | 471/930 [04:12<06:05,  1.26it/s]
{'loss': 0.1117, 'grad_norm': 0.5469021201133728, 'learning_rate': 4.5611522921134394e-05, 'epoch': 5.1}

 51%|████████████████████████████████████▎                                  | 476/930 [04:14<03:35,  2.11it/s]

 52%|████████████████████████████████████▋                                  | 481/930 [04:16<03:06,  2.41it/s]
{'loss': 0.1045, 'grad_norm': 0.4180070161819458, 'learning_rate': 4.427071588614236e-05, 'epoch': 5.19}

 52%|█████████████████████████████████████                                  | 486/930 [04:18<03:04,  2.40it/s]

 53%|█████████████████████████████████████▍                                 | 491/930 [04:20<02:57,  2.47it/s]
{'loss': 0.1424, 'grad_norm': 0.6308942437171936, 'learning_rate': 4.292503588685105e-05, 'epoch': 5.29}

 53%|█████████████████████████████████████▊                                 | 496/930 [04:22<02:57,  2.44it/s]
{'loss': 0.1399, 'grad_norm': 0.7808712124824524, 'learning_rate': 4.202596675354851e-05, 'epoch': 5.35}

 54%|██████████████████████████████████████▏                                | 501/930 [04:24<03:08,  2.27it/s]

 54%|██████████████████████████████████████▌                                | 505/930 [04:26<02:56,  2.41it/s]
{'loss': 0.1296, 'grad_norm': 1.2814581394195557, 'learning_rate': 4.0675579200557246e-05, 'epoch': 5.45}

 55%|██████████████████████████████████████▉                                | 510/930 [04:28<02:52,  2.44it/s]
{'loss': 0.1086, 'grad_norm': 0.8824569582939148, 'learning_rate': 3.977479741529738e-05, 'epoch': 5.52}

 55%|███████████████████████████████████████▎                               | 515/930 [04:30<02:51,  2.41it/s]

 56%|███████████████████████████████████████▋                               | 520/930 [04:32<02:46,  2.47it/s]
{'loss': 0.1532, 'grad_norm': 0.7925428748130798, 'learning_rate': 3.842398163144899e-05, 'epoch': 5.61}

 56%|████████████████████████████████████████                               | 525/930 [04:34<02:45,  2.45it/s]

 57%|████████████████████████████████████████▍                              | 530/930 [04:36<02:39,  2.52it/s]
{'loss': 0.0979, 'grad_norm': 0.8033747673034668, 'learning_rate': 3.707496411314896e-05, 'epoch': 5.71}

 58%|████████████████████████████████████████▊                              | 535/930 [04:38<02:43,  2.42it/s]
{'loss': 0.1025, 'grad_norm': 0.5153221487998962, 'learning_rate': 3.617737839999608e-05, 'epoch': 5.77}

 58%|█████████████████████████████████████████▏                             | 540/930 [04:40<02:34,  2.52it/s]

 59%|█████████████████████████████████████████▌                             | 545/930 [04:42<02:38,  2.43it/s]
{'loss': 0.1591, 'grad_norm': 0.8052717447280884, 'learning_rate': 3.483477674576955e-05, 'epoch': 5.87}

 59%|█████████████████████████████████████████▉                             | 549/930 [04:44<02:37,  2.42it/s]

 60%|██████████████████████████████████████████▎                            | 554/930 [04:46<02:36,  2.40it/s]
{'loss': 0.178, 'grad_norm': 0.8246368765830994, 'learning_rate': 3.349806870497615e-05, 'epoch': 5.97}
 60%|██████████████████████████████████████████▌                            | 558/930 [04:47<02:12,  2.80it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32


 92%|██████████████████████████████████████████████████████████████████▉      | 22/24 [00:03<00:00,  5.23it/s]
Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-558/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-558/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-558/preprocessor_config.json
Deleting older checkpoint [checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-372] due to args.save_total_limit
{'loss': 0.0608, 'grad_norm': 0.680706799030304, 'learning_rate': 3.261095775931244e-05, 'epoch': 6.03}
 61%|██████████████████████████████████████████▉                            | 563/930 [04:56<05:11,  1.18it/s]
{'loss': 0.0964, 'grad_norm': 0.41282981634140015, 'learning_rate': 3.2168779485739086e-05, 'epoch': 6.06}


 61%|███████████████████████████████████████████▍                           | 569/930 [04:59<02:49,  2.13it/s]

 62%|███████████████████████████████████████████▋                           | 572/930 [05:02<04:20,  1.37it/s]
{'loss': 0.1147, 'grad_norm': 0.8183624148368835, 'learning_rate': 3.084842583117153e-05, 'epoch': 6.16}

 62%|████████████████████████████████████████████                           | 577/930 [05:04<02:52,  2.05it/s]
{'loss': 0.1164, 'grad_norm': 0.940083384513855, 'learning_rate': 2.997389870965118e-05, 'epoch': 6.23}

 63%|████████████████████████████████████████████▍                          | 582/930 [05:06<02:27,  2.37it/s]

 63%|████████████████████████████████████████████▊                          | 587/930 [05:08<02:22,  2.40it/s]

 64%|█████████████████████████████████████████████▏                         | 592/930 [05:11<02:20,  2.41it/s]
{'loss': 0.0861, 'grad_norm': 0.4012226164340973, 'learning_rate': 2.8240539491292938e-05, 'epoch': 6.35}

 64%|█████████████████████████████████████████████▌                         | 596/930 [05:12<02:33,  2.18it/s]

 65%|█████████████████████████████████████████████▊                         | 600/930 [05:14<02:42,  2.03it/s]
{'loss': 0.0901, 'grad_norm': 0.544815719127655, 'learning_rate': 2.6955982451604206e-05, 'epoch': 6.45}

 65%|██████████████████████████████████████████████▏                        | 605/930 [05:17<02:18,  2.34it/s]
{'loss': 0.1247, 'grad_norm': 0.6861065626144409, 'learning_rate': 2.6107789886207195e-05, 'epoch': 6.52}

 65%|██████████████████████████████████████████████▍                        | 609/930 [05:18<02:09,  2.48it/s]

 66%|██████████████████████████████████████████████▉                        | 614/930 [05:20<02:11,  2.39it/s]
{'loss': 0.1642, 'grad_norm': 1.0345288515090942, 'learning_rate': 2.484884457557696e-05, 'epoch': 6.61}

 67%|███████████████████████████████████████████████▎                       | 619/930 [05:22<02:04,  2.50it/s]

 67%|███████████████████████████████████████████████▋                       | 624/930 [05:24<02:02,  2.50it/s]
{'loss': 0.1218, 'grad_norm': 0.7591164112091064, 'learning_rate': 2.360718700813651e-05, 'epoch': 6.71}

 68%|████████████████████████████████████████████████                       | 629/930 [05:26<01:59,  2.52it/s]

 68%|████████████████████████████████████████████████▍                      | 634/930 [05:29<02:10,  2.27it/s]
{'loss': 0.0871, 'grad_norm': 0.5798861384391785, 'learning_rate': 2.2384233937694626e-05, 'epoch': 6.81}

 69%|████████████████████████████████████████████████▊                      | 639/930 [05:31<01:56,  2.49it/s]
{'loss': 0.1365, 'grad_norm': 1.2959113121032715, 'learning_rate': 2.1580013296621657e-05, 'epoch': 6.87}

 69%|█████████████████████████████████████████████████                      | 643/930 [05:32<01:54,  2.50it/s]

 70%|█████████████████████████████████████████████████▍                     | 647/930 [05:34<02:15,  2.09it/s]
{'loss': 0.0838, 'grad_norm': 0.8399250507354736, 'learning_rate': 2.0391324041730665e-05, 'epoch': 6.97}
 70%|█████████████████████████████████████████████████▋                     | 651/930 [05:36<01:59,  2.33it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32



100%|█████████████████████████████████████████████████████████████████████████| 24/24 [00:04<00:00,  7.06it/s]
Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-651/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-651/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-651/preprocessor_config.json
Deleting older checkpoint [checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-465] due to args.save_total_limit
 70%|█████████████████████████████████████████████████▊                     | 652/930 [05:44<10:00,  2.16s/it]
{'loss': 0.109, 'grad_norm': 0.7114499807357788, 'learning_rate': 1.9611211768477173e-05, 'epoch': 7.03}

 71%|██████████████████████████████████████████████████▏                    | 657/930 [05:46<03:37,  1.25it/s]

 71%|██████████████████████████████████████████████████▌                    | 662/930 [05:48<02:06,  2.11it/s]
{'loss': 0.0758, 'grad_norm': 0.5264660716056824, 'learning_rate': 1.8460553236696448e-05, 'epoch': 7.13}

 72%|██████████████████████████████████████████████████▉                    | 667/930 [05:50<01:51,  2.37it/s]

 72%|███████████████████████████████████████████████████▏                   | 671/930 [05:52<01:45,  2.45it/s]
{'loss': 0.0825, 'grad_norm': 0.47259053587913513, 'learning_rate': 1.7334471604410367e-05, 'epoch': 7.23}

 73%|███████████████████████████████████████████████████▌                   | 676/930 [05:54<01:46,  2.38it/s]
{'loss': 0.0772, 'grad_norm': 0.7266169190406799, 'learning_rate': 1.659804005618769e-05, 'epoch': 7.29}

 73%|███████████████████████████████████████████████████▉                   | 681/930 [05:56<01:38,  2.53it/s]

 74%|████████████████████████████████████████████████████▎                  | 686/930 [05:58<01:39,  2.44it/s]
{'loss': 0.1135, 'grad_norm': 0.7320053577423096, 'learning_rate': 1.5515760698093485e-05, 'epoch': 7.39}

 74%|████████████████████████████████████████████████████▊                  | 691/930 [06:00<01:40,  2.37it/s]

 75%|█████████████████████████████████████████████████████▏                 | 696/930 [06:02<01:43,  2.27it/s]
{'loss': 0.1116, 'grad_norm': 0.4691409766674042, 'learning_rate': 1.4461418301200665e-05, 'epoch': 7.48}

 75%|█████████████████████████████████████████████████████▍                 | 700/930 [06:04<01:41,  2.27it/s]

 76%|█████████████████████████████████████████████████████▊                 | 705/930 [06:06<01:36,  2.34it/s]
{'loss': 0.1282, 'grad_norm': 0.9643089771270752, 'learning_rate': 1.3436215889310433e-05, 'epoch': 7.58}

 76%|██████████████████████████████████████████████████████▏                | 709/930 [06:08<01:33,  2.37it/s]

 77%|██████████████████████████████████████████████████████▍                | 713/930 [06:10<01:48,  2.00it/s]
{'loss': 0.0951, 'grad_norm': 0.5387899875640869, 'learning_rate': 1.2441323236972536e-05, 'epoch': 7.68}

 77%|██████████████████████████████████████████████████████▋                | 717/930 [06:12<01:52,  1.89it/s]

 78%|███████████████████████████████████████████████████████                | 722/930 [06:14<01:33,  2.22it/s]
{'loss': 0.1087, 'grad_norm': 0.8207783699035645, 'learning_rate': 1.1477875534751192e-05, 'epoch': 7.77}

 78%|███████████████████████████████████████████████████████▍               | 726/930 [06:16<01:26,  2.37it/s]

 79%|███████████████████████████████████████████████████████▊               | 731/930 [06:18<01:20,  2.48it/s]
{'loss': 0.0802, 'grad_norm': 0.5559310913085938, 'learning_rate': 1.0546972093952114e-05, 'epoch': 7.87}

 79%|████████████████████████████████████████████████████████▏              | 736/930 [06:20<01:19,  2.45it/s]
{'loss': 0.0815, 'grad_norm': 0.8384805917739868, 'learning_rate': 9.944976042521465e-06, 'epoch': 7.94}

 80%|████████████████████████████████████████████████████████▌              | 741/930 [06:22<01:16,  2.46it/s]
 80%|████████████████████████████████████████████████████████▊              | 744/930 [06:23<01:05,  2.83it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32


 92%|██████████████████████████████████████████████████████████████████▉      | 22/24 [00:04<00:00,  5.59it/s]
Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-744/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-744/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-744/preprocessor_config.json
Deleting older checkpoint [checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-558] due to args.save_total_limit
{'loss': 0.0968, 'grad_norm': 0.7044014930725098, 'learning_rate': 9.07065454483043e-06, 'epoch': 8.03}
 80%|█████████████████████████████████████████████████████████              | 748/930 [06:32<03:27,  1.14s/it]

 81%|█████████████████████████████████████████████████████████▍             | 752/930 [06:35<01:59,  1.49it/s]
{'loss': 0.0695, 'grad_norm': 0.5592620372772217, 'learning_rate': 8.507319690142871e-06, 'epoch': 8.1}

 81%|█████████████████████████████████████████████████████████▋             | 756/930 [06:36<01:22,  2.10it/s]

 82%|██████████████████████████████████████████████████████████             | 760/930 [06:38<01:23,  2.04it/s]

 82%|██████████████████████████████████████████████████████████▍            | 765/930 [06:41<01:17,  2.14it/s]
{'loss': 0.1008, 'grad_norm': 0.8802925944328308, 'learning_rate': 7.428841731250695e-06, 'epoch': 8.23}

 83%|██████████████████████████████████████████████████████████▋            | 769/930 [06:42<01:08,  2.36it/s]

 83%|███████████████████████████████████████████████████████████            | 774/930 [06:45<01:13,  2.11it/s]
{'loss': 0.0643, 'grad_norm': 0.4916892945766449, 'learning_rate': 6.6632237535656995e-06, 'epoch': 8.32}

 84%|███████████████████████████████████████████████████████████▍           | 778/930 [06:46<01:07,  2.24it/s]
{'loss': 0.0656, 'grad_norm': 0.5690427422523499, 'learning_rate': 6.1738917670064194e-06, 'epoch': 8.39}

 84%|███████████████████████████████████████████████████████████▊           | 783/930 [06:48<00:59,  2.46it/s]

 85%|████████████████████████████████████████████████████████████▏          | 788/930 [06:50<00:58,  2.42it/s]
{'loss': 0.0876, 'grad_norm': 0.33435022830963135, 'learning_rate': 5.4721341643392845e-06, 'epoch': 8.48}

 85%|████████████████████████████████████████████████████████████▌          | 793/930 [06:52<00:56,  2.43it/s]

 86%|████████████████████████████████████████████████████████████▉          | 798/930 [06:54<00:54,  2.44it/s]
{'loss': 0.0732, 'grad_norm': 0.5176781415939331, 'learning_rate': 4.809773482945601e-06, 'epoch': 8.58}

 86%|█████████████████████████████████████████████████████████████▎         | 803/930 [06:57<00:52,  2.41it/s]
{'loss': 0.1135, 'grad_norm': 0.9945104718208313, 'learning_rate': 4.39046196766594e-06, 'epoch': 8.65}

 87%|█████████████████████████████████████████████████████████████▋         | 808/930 [06:59<00:50,  2.44it/s]

 87%|██████████████████████████████████████████████████████████████         | 813/930 [07:01<00:49,  2.37it/s]

 88%|██████████████████████████████████████████████████████████████▏        | 815/930 [07:01<00:48,  2.39it/s]

 88%|██████████████████████████████████████████████████████████████▎        | 817/930 [07:05<01:41,  1.11it/s]

 88%|██████████████████████████████████████████████████████████████▌        | 820/930 [07:06<01:14,  1.48it/s]

 89%|██████████████████████████████████████████████████████████████▉        | 824/930 [07:08<01:02,  1.69it/s]

 89%|███████████████████████████████████████████████████████████████▏       | 828/930 [07:11<00:54,  1.88it/s]
{'loss': 0.104, 'grad_norm': 0.7709938883781433, 'learning_rate': 2.8957967690084986e-06, 'epoch': 8.9}

 89%|███████████████████████████████████████████████████████████████▌       | 832/930 [07:13<00:48,  2.03it/s]
{'loss': 0.0835, 'grad_norm': 0.5318508148193359, 'learning_rate': 2.568723249806575e-06, 'epoch': 8.97}
 90%|███████████████████████████████████████████████████████████████▉       | 837/930 [07:14<00:40,  2.30it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32


 92%|██████████████████████████████████████████████████████████████████▉      | 22/24 [00:04<00:00,  5.55it/s]
Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-837/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-837/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-837/preprocessor_config.json
Deleting older checkpoint [checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-651] due to args.save_total_limit
 90%|███████████████████████████████████████████████████████████████▉       | 838/930 [07:23<03:19,  2.17s/it]

 91%|████████████████████████████████████████████████████████████████▎      | 843/930 [07:25<01:07,  1.28it/s]
{'loss': 0.102, 'grad_norm': 0.8569275140762329, 'learning_rate': 2.1137555282605325e-06, 'epoch': 9.06}

 91%|████████████████████████████████████████████████████████████████▋      | 848/930 [07:27<00:38,  2.13it/s]
{'loss': 0.1096, 'grad_norm': 0.905979335308075, 'learning_rate': 1.8344297439980475e-06, 'epoch': 9.13}

 92%|█████████████████████████████████████████████████████████████████      | 852/930 [07:28<00:32,  2.39it/s]

 92%|█████████████████████████████████████████████████████████████████▍     | 857/930 [07:30<00:30,  2.37it/s]
{'loss': 0.0788, 'grad_norm': 0.604543149471283, 'learning_rate': 1.4517742444023665e-06, 'epoch': 9.23}

 93%|█████████████████████████████████████████████████████████████████▊     | 862/930 [07:33<00:31,  2.17it/s]

 93%|██████████████████████████████████████████████████████████████████     | 865/930 [07:34<00:33,  1.96it/s]

 94%|██████████████████████████████████████████████████████████████████▍    | 870/930 [07:37<00:26,  2.23it/s]
{'loss': 0.0764, 'grad_norm': 0.5467578768730164, 'learning_rate': 1.010055061834474e-06, 'epoch': 9.35}

 94%|██████████████████████████████████████████████████████████████████▋    | 874/930 [07:39<00:28,  1.94it/s]

 94%|███████████████████████████████████████████████████████████████████    | 878/930 [07:41<00:26,  1.99it/s]

 95%|███████████████████████████████████████████████████████████████████▎   | 882/930 [07:43<00:23,  2.01it/s]
{'loss': 0.0855, 'grad_norm': 0.4765613079071045, 'learning_rate': 6.474202242868411e-07, 'epoch': 9.48}

 95%|███████████████████████████████████████████████████████████████████▋   | 887/930 [07:45<00:18,  2.33it/s]
{'loss': 0.081, 'grad_norm': 0.3349532186985016, 'learning_rate': 4.959956007479338e-07, 'epoch': 9.55}

 96%|████████████████████████████████████████████████████████████████████   | 892/930 [07:47<00:17,  2.21it/s]

 96%|████████████████████████████████████████████████████████████████████▎  | 895/930 [07:48<00:17,  2.00it/s]

 97%|████████████████████████████████████████████████████████████████████▋  | 899/930 [07:50<00:15,  1.96it/s]
{'loss': 0.0883, 'grad_norm': 0.32500335574150085, 'learning_rate': 2.533158771286903e-07, 'epoch': 9.68}

 97%|█████████████████████████████████████████████████████████████████████  | 904/930 [07:53<00:11,  2.25it/s]

 98%|█████████████████████████████████████████████████████████████████████▍ | 909/930 [07:55<00:08,  2.41it/s]
{'loss': 0.0848, 'grad_norm': 0.7906457781791687, 'learning_rate': 1.2419169490051287e-07, 'epoch': 9.77}

 98%|█████████████████████████████████████████████████████████████████████▊ | 914/930 [07:57<00:06,  2.47it/s]
{'loss': 0.089, 'grad_norm': 0.6481459140777588, 'learning_rate': 6.337918078914041e-08, 'epoch': 9.84}

 99%|██████████████████████████████████████████████████████████████████████▏| 919/930 [07:59<00:04,  2.43it/s]

 99%|██████████████████████████████████████████████████████████████████████▌| 924/930 [08:01<00:02,  2.50it/s]
{'loss': 0.0976, 'grad_norm': 1.0209406614303589, 'learning_rate': 1.0142919314679588e-08, 'epoch': 9.94}
100%|███████████████████████████████████████████████████████████████████████| 930/930 [08:03<00:00,  2.72it/s]***** Running Evaluation *****
  Num examples = 739
  Batch size = 32
{'loss': 0.0586, 'grad_norm': 0.45546117424964905, 'learning_rate': 0.0, 'epoch': 10.0}


 92%|██████████████████████████████████████████████████████████████████▉      | 22/24 [00:03<00:00,  5.58it/s]
{'eval_loss': 0.17096197605133057, 'eval_accuracy': 0.952638700947226, 'eval_runtime': 6.5137, 'eval_samples_per_second': 113.454, 'eval_steps_per_second': 3.685, 'epoch': 10.0}
Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-930/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-930/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-930/preprocessor_config.json
Deleting older checkpoint [checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-837] due to args.save_total_limit
Training completed. Do not forget to share your model on huggingface.co/models =)
Loading best model from ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/checkpoint-744 (score: 0.9539918809201624).
100%|███████████████████████████████████████████████████████████████████████| 930/930 [08:10<00:00,  1.90it/s]
***** Running Evaluation *****
  Num examples = 739
  Batch size = 32


100%|█████████████████████████████████████████████████████████████████████████| 24/24 [00:07<00:00,  3.28it/s]
Saving model checkpoint to ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16
Configuration saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/config.json
Model weights saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/model.safetensors
Image processor saved in ./checkpoints/vit-base-oxford-iiit-pets/2024-06-01:22-16/preprocessor_config.json